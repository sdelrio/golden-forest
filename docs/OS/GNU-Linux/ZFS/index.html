<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-OS/GNU-Linux/ZFS/zfs" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.7.0"><title data-rh=true>ZFS | The Golden Forest</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:image content=https://www.lorien.cloud/img/docusaurus-social-card.jpg><meta data-rh=true name=twitter:image content=https://www.lorien.cloud/img/docusaurus-social-card.jpg><meta data-rh=true property=og:url content=https://www.lorien.cloud/docs/OS/GNU-Linux/ZFS/><meta data-rh=true property=og:locale content=en><meta data-rh=true name=docusaurus_locale content=en><meta data-rh=true name=docsearch:language content=en><meta data-rh=true name=docusaurus_version content=current><meta data-rh=true name=docusaurus_tag content=docs-default-current><meta data-rh=true name=docsearch:version content=current><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current><meta data-rh=true property=og:title content="ZFS | The Golden Forest"><meta data-rh=true name=description content="ZFS combines a file system with a volume manager."><meta data-rh=true property=og:description content="ZFS combines a file system with a volume manager."><link data-rh=true rel=icon href=/img/favicon.ico><link data-rh=true rel=canonical href=https://www.lorien.cloud/docs/OS/GNU-Linux/ZFS/><link data-rh=true rel=alternate href=https://www.lorien.cloud/docs/OS/GNU-Linux/ZFS/ hreflang=en><link data-rh=true rel=alternate href=https://www.lorien.cloud/docs/OS/GNU-Linux/ZFS/ hreflang=x-default><link data-rh=true rel=preconnect href=https://5VR022LUD5-dsn.algolia.net crossorigin=anonymous><link rel=alternate type=application/rss+xml href=/blog/rss.xml title="The Golden Forest RSS Feed"><link rel=alternate type=application/atom+xml href=/blog/atom.xml title="The Golden Forest Atom Feed"><link rel=search type=application/opensearchdescription+xml title="The Golden Forest" href=/opensearch.xml><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css type=text/css integrity=sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM crossorigin=anonymous><link rel=stylesheet href=/assets/css/styles.e13b0833.css><script src=/assets/js/runtime~main.b6b6e229.js defer></script><script src=/assets/js/main.3a7dcdc0.js defer></script><body class=navigation-with-keyboard><script>!function(){var t,e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t=null!==e?e:"light",document.documentElement.setAttribute("data-theme",t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><link rel=preload as=image href=/img/logo.svg><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="navbar navbar--fixed-top"><div class=navbar__inner><div class=navbar__items><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/><div class=navbar__logo><img src=/img/logo.svg alt=Logo class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/img/logo.svg alt=Logo class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">The Golden Forest</b></a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/docs/docs-intro>IT</a><a class="navbar__item navbar__link" docid=tutorial-intro href=/tutorial/tutorial-intro>Add content</a><a class="navbar__item navbar__link" href=/blog>Blog</a></div><div class="navbar__items navbar__items--right"><a href=https://github.com/sdelrio/golden-forest target=_blank rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live=polite aria-pressed=false><svg viewBox="0 0 24 24" width=24 height=24 class=lightToggleIcon_pyhR><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 class=darkToggleIcon_wfgR><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg></button></div><div class=navbarSearchContainer_Bca1><button type=button class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 20 20" aria-hidden=true><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke=currentColor fill=none fill-rule=evenodd stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>Search</span></span><span class=DocSearch-Button-Keys></span></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class=sidebar_njMd><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/docs/docs-intro>Introduction</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/Backup/borg>Backup</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/category/cloud-infrastructure>Cloud Infrastructure</a><button aria-label="Expand sidebar category 'Cloud Infrastructure'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/category/cloud-platform>Cloud Platform</a><button aria-label="Expand sidebar category 'Cloud Platform'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/category/coding>Coding</a><button aria-label="Expand sidebar category 'Coding'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/Containers/>Containers</a><button aria-label="Expand sidebar category 'Containers'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/DevOps/>DevOps</a><button aria-label="Expand sidebar category 'DevOps'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/Domotic/>Domotic</a><button aria-label="Expand sidebar category 'Domotic'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/category/dnd>Games</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/Hardware/CPU/coolers>Hardware</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/HomeLab/Raspberry-Pi/>HomeLab</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/Multimedia/BDSup2Sub>Multimedia</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/Networking/>Networking</a><button aria-label="Expand sidebar category 'Networking'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" href=/docs/category/operative-systems>Operative Systems</a><button aria-label="Collapse sidebar category 'Operative Systems'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role=button aria-expanded=true tabindex=0 href=/docs/OS/GNU-Linux/Drivers/AMD/radeon>GNU-Linux</a></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/OS/GNU-Linux/Drivers/AMD/radeon>Drivers</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/OS/GNU-Linux/HDs/smart>HDs</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/OS/GNU-Linux/Hardware/CPU/Benchmarks/7zip>Hardware</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/OS/GNU-Linux/KVM/kvm-qemu>KVM</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/OS/GNU-Linux/Kernel/linux-5.15>Kernel</a></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/OS/GNU-Linux/Makefile>Makefile</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/OS/GNU-Linux/Networking/traceroute>Networking</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/OS/GNU-Linux/NixOS/flakes>NixOS</a></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/OS/GNU-Linux/PXE>PXE boot</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/docs/OS/GNU-Linux/TrueNAS/>TrueNAS</a><button aria-label="Expand sidebar category 'TrueNAS'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible menu__list-item-collapsible--active"><a class="menu__link menu__link--sublist menu__link--active" aria-current=page tabindex=0 href=/docs/OS/GNU-Linux/ZFS/>ZFS</a><button aria-label="Collapse sidebar category 'ZFS'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/OS/GNU-Linux/ZFS/zsys>ZSysctl</a></ul><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/OS/GNU-Linux/automatic-upgrades>Automatic Upgrades</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/OS/GNU-Linux/clean-system>Clean system</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/OS/GNU-Linux/disk-caching-and-performance>Disk Caching & Performance</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/OS/GNU-Linux/netplan>Netplan</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/OS/GNU-Linux/resolved>Systemd-resolved</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/OS/GNU-Linux/ssh>ssh client</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/OS/GNU-Linux/syslog>Syslog</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/OS/GNU-Linux/wm>Window Managers</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/OS/MacOS/i3-tiling-macos>MacOS</a></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/OS/Nix/>Nix</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/OS/Windows/WSL/nix-configs>Windows</a></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/OS/imaging-tools>Imaging and Cloning tools</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/category/quality-assurance>Quality Assurance</a><button aria-label="Expand sidebar category 'Quality Assurance'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/Security/owasp>Security</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/Shell-Script/bash-unit-testing>Shell & Scripts</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/Software/Backup/duplicati>Software</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/Software-Architecture/microservices>Software-Architecture</a></div></ul></nav><button type=button title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width=20 height=20 aria-hidden=true class=collapseSidebarButtonIcon_kv0_><g fill=#7a7a7a><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"/><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"/></g></svg></button></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs itemscope itemtype=https://schema.org/BreadcrumbList><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/docs/category/operative-systems><span itemprop=name>Operative Systems</span></a><meta itemprop=position content=1><li class=breadcrumbs__item><span class=breadcrumbs__link>GNU-Linux</span><meta itemprop=position content=2><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link itemprop=name>ZFS</span><meta itemprop=position content=3></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>ZFS</h1></header>
<p><a href=https://en.wikipedia.org/wiki/ZFS target=_blank rel="noopener noreferrer">ZFS</a> combines a file system with a volume manager.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=instal-linux-mint-20-with-zfs>Instal Linux Mint 20 with ZFS<a href=#instal-linux-mint-20-with-zfs class=hash-link aria-label="Direct link to Instal Linux Mint 20 with ZFS" title="Direct link to Instal Linux Mint 20 with ZFS">​</a></h2>
<p>Before starting installation, open a terminal and run this command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">sudo aptitude -y install libzfs2linux zfs-initramfs zfsutils-linux zfs-zed</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>Then start installation and when you get to the filesystem picker, choose advanced and select <strong>"Experimental ZFS"</strong>. Continue as you would normally do.</p>
<ul>
<li><a href="https://forums.linuxmint.com/viewtopic.php?t=306210" target=_blank rel="noopener noreferrer">ZFS and Linux Mint 20 forums</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=mount>Mount<a href=#mount class=hash-link aria-label="Direct link to Mount" title="Direct link to Mount">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=mounts-external-disk-share>mounts external disk share<a href=#mounts-external-disk-share class=hash-link aria-label="Direct link to mounts external disk share" title="Direct link to mounts external disk share">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">zfs mount -l -a</span><br></span><span class=token-line style=color:#393A34><span class="token plain">zfs share hddpool/imagenes</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=import-a-pool-as-readonly>Import a pool as readonly<a href=#import-a-pool-as-readonly class=hash-link aria-label="Direct link to Import a pool as readonly" title="Direct link to Import a pool as readonly">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">zpool import -o readonly=on {{ pool_name }}</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=mount-a-zfs-snapshot-in-a-directory-as-readonly>Mount a ZFS snapshot in a directory as readonly<a href=#mount-a-zfs-snapshot-in-a-directory-as-readonly class=hash-link aria-label="Direct link to Mount a ZFS snapshot in a directory as readonly" title="Direct link to Mount a ZFS snapshot in a directory as readonly">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">mount -t zfs {{ pool_name }}/{{ snapshot_name }} {{ mount_path }} -o ro</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=pool>Pool<a href=#pool class=hash-link aria-label="Direct link to Pool" title="Direct link to Pool">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=create>Create<a href=#create class=hash-link aria-label="Direct link to Create" title="Direct link to Create">​</a></h3>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"/></svg></span>Note: Use <code>disk by-id</code></div><div class=admonitionContent_BuS1><p>Use <code>/dev/disk/by-id/</code> instead <code>/dev/sdX</code>. This way doesn't matter where you plug the hard disk in the controller.</div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=command>Command<a href=#command class=hash-link aria-label="Direct link to Command" title="Direct link to Command">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">zpool create hddpool mirror /dev/disk/by-id/... /dev/disk/by-id/...</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=sample>Sample<a href=#sample class=hash-link aria-label="Direct link to Sample" title="Direct link to Sample">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">zpool create hddpool mirror /dev/disk/by-id/ata-Hitachi_HDS5C3020ALA632_ML4220F424ERTK /dev/disk/by-id/ata-Hitachi_HDS5C3020ALA632_ML4220F31666VK</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=list>List<a href=#list class=hash-link aria-label="Direct link to List" title="Direct link to List">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">zpool list </span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">NAME      SIZE  ALLOC   FREE  CKPOINT  EXPANDSZ   FRAG    CAP  DEDUP    HEALTH  ALTROOT</span><br></span><span class=token-line style=color:#393A34><span class="token plain">bpool    1,88G   531M  1,36G        -         -     1%    27%  1.00x    ONLINE  -</span><br></span><span class=token-line style=color:#393A34><span class="token plain">hddpool  1,81T   461G  1,36T        -         -     0%    24%  1.00x    ONLINE  -</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool     460G   164G   296G        -         -    24%    35%  1.00x    ONLINE  -</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=cache-zilarc>Cache (ZIL/ARC)<a href=#cache-zilarc class=hash-link aria-label="Direct link to Cache (ZIL/ARC)" title="Direct link to Cache (ZIL/ARC)">​</a></h3>
<ul>
<li>
<p>ZFS Intent Log, or ZIL, is designed to buffer <strong>WRITE</strong> operations</p>
</li>
<li>
<p>ARC and L2ARC are ment for <strong>READ</strong> operations</p>
</li>
<li>
<p><a href=https://linuxhint.com/configuring-zfs-cache/ target=_blank rel="noopener noreferrer">Configure ZFS cache for high Speed IO</a>
<a href=https://jrs-s.net/2019/05/02/zfs-sync-async-zil-slog/ target=_blank rel="noopener noreferrer">ZFS sync/async + ZIL/SLOG explained</a></p>
</li>
<li>
<p><a href=https://www.truenas.com/docs/references/slog/ target=_blank rel="noopener noreferrer">TrueNas SLOG</a></p>
</li>
<li>
<p>L2ARC is AWESOME on ZFS - Why does EVERYONE say it's NOT?</p>
</li>
</ul>
<iframe width=560 height=315 src="https://www.youtube.com/embed/JY_-I6lQTtI?si=Pn4vPRk2BA0vH2vL" title="YouTube video player" frameborder=0 allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"></iframe>
<ul>
<li>Best Practices for OpenZFS L2ARC in the Era of NVMe (SDC 2019)</li>
</ul>
<iframe width=560 height=315 src="https://www.youtube.com/embed/yHgSU6iqrlE?si=6t3xnNhrnJ0XhEap" title="YouTube video player" frameborder=0 allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"></iframe>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=zil-log>ZIL Log<a href=#zil-log class=hash-link aria-label="Direct link to ZIL Log" title="Direct link to ZIL Log">​</a></h4>
<p><a href=https://www.servethehome.com/exploring-best-zfs-zil-slog-ssd-intel-optane-nand/ target=_blank rel="noopener noreferrer">Exploring the Best ZFS ZIL SLOG SSD with Intel Optane and NAND</a></p>
<ul>
<li>2020 winner: Optane 900p 28GB</li>
</ul>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id=sample-creating-zil-log>Sample creating ZIL log<a href=#sample-creating-zil-log class=hash-link aria-label="Direct link to Sample creating ZIL log" title="Direct link to Sample creating ZIL log">​</a></h5>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">$ sudo zpool add hddpool log /dev/disk/by-id/ata-DP-CT050M4SSC2_000000001207032EBBDB</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$ sudo zpool iostat hddpool -v</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                                                  capacity     operations     bandwidth </span><br></span><span class=token-line style=color:#393A34><span class="token plain">pool                                            alloc   free   read  write   read  write</span><br></span><span class=token-line style=color:#393A34><span class="token plain">----------------------------------------------  -----  -----  -----  -----  -----  -----</span><br></span><span class=token-line style=color:#393A34><span class="token plain">hddpool                                          433G  1,39T      6    111  61,5K  83,2M</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  mirror                                         433G  1,39T      6    111  61,5K  83,2M</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    ata-Hitachi_HDS5C3020ALA632_ML4220F312ERTK      -      -      3     55  31,8K  41,6M</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    ata-Hitachi_HDS5C3020ALA632_ML4220F31538VK      -      -      3     56  29,6K  41,6M</span><br></span><span class=token-line style=color:#393A34><span class="token plain">logs                                                -      -      -      -      -      -</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  ata-DP-CT050M4SSC2_000000001207032EBBDB           0  59,5G      0      0     10  1,02K</span><br></span><span class=token-line style=color:#393A34><span class="token plain">----------------------------------------------  -----  -----  -----  -----  -----  -----</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<ul>
<li>Force sync always to pool log, this can lower a lot the performance, even if the log is a normal SSD</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">sudo zfs set sync=always hddpool</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=clear-arz-zfs-cache>Clear arz zfs cache<a href=#clear-arz-zfs-cache class=hash-link aria-label="Direct link to Clear arz zfs cache" title="Direct link to Clear arz zfs cache">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">sudo sh -c 'echo 3 > /proc/sys/vm/drop_caches'</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=upgrade-zpool>Upgrade zpool<a href=#upgrade-zpool class=hash-link aria-label="Direct link to Upgrade zpool" title="Direct link to Upgrade zpool">​</a></h3>
<ol>
<li><code>zpool scrub pvepool1</code></li>
<li><code>zpool status pvepool1</code></li>
<li>Pull one disk</li>
<li>Insert new  disk</li>
<li><code>zpool status pvepool1</code></li>
<li><code>dmesg</code></li>
<li><code>zpool replace pvepool1 /dev/disk/by-id/...</code></li>
<li><code>zpool scrub pvepool1</code></li>
<li><code>zpool status pvepool1</code></li>
</ol>
<p>Repeat the process for other disks, and then turn on autoexpand</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">zpool set autoexpand=on pvepool1</span><br></span><span class=token-line style=color:#393A34><span class="token plain">zpool online -e pvepool1 /dev/disk/by-id/...id1</span><br></span><span class=token-line style=color:#393A34><span class="token plain">zpool online -e pvepool1 /dev/disk/by-id/...id2</span><br></span><span class=token-line style=color:#393A34><span class="token plain">zpool online -e pvepool1 /dev/disk/by-id/...id3</span><br></span><span class=token-line style=color:#393A34><span class="token plain">zpool online -e pvepool1 /dev/disk/by-id/...id4</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=references>References<a href=#references class=hash-link aria-label="Direct link to References" title="Direct link to References">​</a></h4>
<ul>
<li><a href=https://b3n.org/56tb-zpool-upgrade/ target=_blank rel="noopener noreferrer">56TB Zpool upgrade</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=zfs-filesystem-or-volumes-zvol>ZFS Filesystem or volumes (ZVOL)<a href=#zfs-filesystem-or-volumes-zvol class=hash-link aria-label="Direct link to ZFS Filesystem or volumes (ZVOL)" title="Direct link to ZFS Filesystem or volumes (ZVOL)">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=create-1>Create<a href=#create-1 class=hash-link aria-label="Direct link to Create" title="Direct link to Create">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">zfs create tank/home</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=samples>Samples<a href=#samples class=hash-link aria-label="Direct link to Samples" title="Direct link to Samples">​</a></h3>
<ul>
<li>Create with default parameters</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">sudo zfs create hddpool/imagenes</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<ul>
<li>Create with compression enabled</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">sudo zfs create hddpool/vms -o compress=on</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<ul>
<li>Create and destroy a 64GB volume, compressed without encruyption</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">sudo zfs create rpool/vm-win10 -V 64G -o compress=on -o encryption=off</span><br></span><span class=token-line style=color:#393A34><span class="token plain">sudo zfs destroy rpool/vm-win10</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=list-volumes>List Volumes<a href=#list-volumes class=hash-link aria-label="Direct link to List Volumes" title="Direct link to List Volumes">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=with-space-usage>With space usage<a href=#with-space-usage class=hash-link aria-label="Direct link to With space usage" title="Direct link to With space usage">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">zfs list -o space</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">NAME                                       AVAIL   USED  USEDSNAP  USEDDS  USEDREFRESERV  USEDCHILD</span><br></span><span class=token-line style=color:#393A34><span class="token plain">bpool                                      1,23G   530M        0B     96K             0B       530M</span><br></span><span class=token-line style=color:#393A34><span class="token plain">bpool/BOOT                                 1,23G   529M        0B     96K             0B       529M</span><br></span><span class=token-line style=color:#393A34><span class="token plain">bpool/BOOT/ubuntu_awq93l                   1,23G   529M     81,8M    447M             0B         0B</span><br></span><span class=token-line style=color:#393A34><span class="token plain">bpool/BOOT/ubuntu_awq93l@autozsys_7718mv       -    80K         -       -              -          -</span><br></span><span class=token-line style=color:#393A34><span class="token plain">bpool/BOOT/ubuntu_awq93l@autozsys_sslfo1       -    80K         -       -              -          -</span><br></span><span class=token-line style=color:#393A34><span class="token plain">bpool/BOOT/ubuntu_awq93l@autozsys_4idbos       -    80K         -       -              -          -</span><br></span><span class=token-line style=color:#393A34><span class="token plain">bpool/BOOT/ubuntu_awq93l@autozsys_6x3nsz       -    72K         -       -              -          -</span><br></span><span class=token-line style=color:#393A34><span class="token plain">bpool/BOOT/ubuntu_awq93l@autozsys_6bkcck       -     0B         -       -              -          -</span><br></span><span class=token-line style=color:#393A34><span class="token plain">bpool/BOOT/ubuntu_awq93l@autozsys_wafxbe       -     0B         -       -              -          -</span><br></span><span class=token-line style=color:#393A34><span class="token plain">(...)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool                                       281G   164G        0B    192K             0B       164G</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool/ROOT                                  281G  49,1G        0B    192K             0B      49,1G</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool/ROOT/ubuntu_awq93l                    281G  49,1G     2,58G   11,2G             0B      35,3G</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool/ROOT/ubuntu_awq93l/srv                281G   272K       80K    192K             0B         0B</span><br></span><span class=token-line style=color:#393A34><span class="token plain">(...)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=snapshots>Snapshots<a href=#snapshots class=hash-link aria-label="Direct link to Snapshots" title="Direct link to Snapshots">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=tools>Tools<a href=#tools class=hash-link aria-label="Direct link to Tools" title="Direct link to Tools">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=ubuntu-zfs-auto-snapshot>Ubuntu <code>zfs-auto-snapshot</code><a href=#ubuntu-zfs-auto-snapshot class=hash-link aria-label="Direct link to ubuntu-zfs-auto-snapshot" title="Direct link to ubuntu-zfs-auto-snapshot">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">$ apt-cache show zfs-auto-snapshot</span><br></span><span class=token-line style=color:#393A34><span class="token plain">Package: zfs-auto-snapshot</span><br></span><span class=token-line style=color:#393A34><span class="token plain">Architecture: all</span><br></span><span class=token-line style=color:#393A34><span class="token plain">Version: 1.2.4-2</span><br></span><span class=token-line style=color:#393A34><span class="token plain">Priority: extra</span><br></span><span class=token-line style=color:#393A34><span class="token plain">Section: multiverse/utils</span><br></span><span class=token-line style=color:#393A34><span class="token plain">Origin: Ubuntu</span><br></span><span class=token-line style=color:#393A34><span class="token plain">Maintainer: Ubuntu Developers [ubuntu-devel-discuss@lists.ubuntu.com](ubuntu-devel-discuss@lists.ubuntu.com)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">Original-Maintainer: Jonathan Carter [jcc@debian.org](jcc@debian.org)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">Bugs: https://bugs.launchpad.net/ubuntu/+filebug</span><br></span><span class=token-line style=color:#393A34><span class="token plain">Installed-Size: 41</span><br></span><span class=token-line style=color:#393A34><span class="token plain">Depends: cron, zfsutils-linux</span><br></span><span class=token-line style=color:#393A34><span class="token plain">Filename: pool/multiverse/z/zfs-auto-snapshot/zfs-auto-snapshot_1.2.4-2_all.deb</span><br></span><span class=token-line style=color:#393A34><span class="token plain">Size: 8652</span><br></span><span class=token-line style=color:#393A34><span class="token plain">MD5sum: 97ae5b7f86d15c41103e5874b2348699</span><br></span><span class=token-line style=color:#393A34><span class="token plain">SHA1: e40530df79e5d4758ea19e34759c10d6f7ac2c95</span><br></span><span class=token-line style=color:#393A34><span class="token plain">SHA256: 2fb1271116627b687e85ef40cc32a772b39c5e82ca5f9a6e687e92e97b67cae7</span><br></span><span class=token-line style=color:#393A34><span class="token plain">Homepage: https://github.com/zfsonlinux/zfs-auto-snapshot</span><br></span><span class=token-line style=color:#393A34><span class="token plain">Description-en: ZFS automatic snapshot service</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> Automatically create, rotate, and destroy periodic ZFS snapshots. This is</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> the utility that creates the @zfs-auto-snap_frequent, @zfs-auto-snap_hourly,</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> @zfs-auto-snap_daily, @zfs-auto-snap_weekly, and @zfs-auto-snap_monthly</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> snapshots if it is installed.</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> .</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> This program is a posixly correct bourne shell script. It depends only on</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> the zfs utilities and cron, and can run in the dash shell.</span><br></span><span class=token-line style=color:#393A34><span class="token plain">Description-md5: 50b5e87f01f77e852b84260e57dc2473</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id=install>Install<a href=#install class=hash-link aria-label="Direct link to Install" title="Direct link to Install">​</a></h5>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">apt install zfs-auto-snapshot</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=list-snapshots-standard>List snapshots (standard)<a href=#list-snapshots-standard class=hash-link aria-label="Direct link to List snapshots (standard)" title="Direct link to List snapshots (standard)">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">zfs list -t snapshot</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">NAME                                                USED  AVAIL     REFER  MOUNTPOINT</span><br></span><span class=token-line style=color:#393A34><span class="token plain">bpool/BOOT/ubuntu_awq93l@autozsys_7718mv             80K      -      355M  -</span><br></span><span class=token-line style=color:#393A34><span class="token plain">bpool/BOOT/ubuntu_awq93l@autozsys_sslfo1             80K      -      355M  -</span><br></span><span class=token-line style=color:#393A34><span class="token plain">bpool/BOOT/ubuntu_awq93l@autozsys_4idbos             80K      -      355M  -</span><br></span><span class=token-line style=color:#393A34><span class="token plain">(...)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool/ROOT/ubuntu_awq93l/srv@autozsys_7718mv         80K      -      192K  -</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool/ROOT/ubuntu_awq93l/srv@autozsys_sslfo1          0B      -      192K  -</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool/ROOT/ubuntu_awq93l/srv@autozsys_4idbos          0B      -      192K  -</span><br></span><span class=token-line style=color:#393A34><span class="token plain">(...)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool/ROOT/ubuntu_awq93l/usr@autozsys_7718mv          0B      -      192K  -</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool/ROOT/ubuntu_awq93l/usr@autozsys_sslfo1          0B      -      192K  -</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool/ROOT/ubuntu_awq93l/usr@autozsys_4idbos                  </span><br></span><span class=token-line style=color:#393A34><span class="token plain">(...)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool/ROOT/ubuntu_awq93l/var/log@autozsys_wafxbe   1,12M      -      189M  -</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool/ROOT/ubuntu_awq93l/var/mail@autozsys_7718mv     0B      -      192K  -</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool/ROOT/ubuntu_awq93l/var/mail@autozsys_sslfo1     0B      -      192K  -</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool/ROOT/ubuntu_awq93l/var/mail@autozsys_4idbos     0B      -      192K  -</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool/ROOT/ubuntu_awq93l/var/mail@autozsys_6x3nsz     0B      -      192K  -</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool/ROOT/ubuntu_awq93l/var/mail@autozsys_6bkcck     0B      -      192K  -</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool/ROOT/ubuntu_awq93l/var/mail@autozsys_wafxbe     0B      -      192K  -</span><br></span><span class=token-line style=color:#393A34><span class="token plain">(...)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool/ROOT/ubuntu_awq93l/var/snap@autozsys_7718mv     0B      -      192K  -</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool/ROOT/ubuntu_awq93l/var/snap@autozsys_sslfo1     0B      -      192K  -</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool/ROOT/ubuntu_awq93l/var/snap@autozsys_4idbos     0B      -      192K  -</span><br></span><span class=token-line style=color:#393A34><span class="token plain">(...)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool/ROOT/ubuntu_awq93l/var/spool@autozsys_7718mv   92K      -      276K  -</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool/ROOT/ubuntu_awq93l/var/spool@autozsys_sslfo1   84K      -      276K  -</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool/ROOT/ubuntu_awq93l/var/spool@autozsys_4idbos   84K      -      276K  -</span><br></span><span class=token-line style=color:#393A34><span class="token plain">(...)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool/ROOT/ubuntu_awq93l/var/www@autozsys_7718mv      0B      -      192K  -</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool/ROOT/ubuntu_awq93l/var/www@autozsys_sslfo1      0B      -      192K  -</span><br></span><span class=token-line style=color:#393A34><span class="token plain">(...)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=list-snapshots-detailed>List snapshots (detailed)<a href=#list-snapshots-detailed class=hash-link aria-label="Direct link to List snapshots (detailed)" title="Direct link to List snapshots (detailed)">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">zfs list -t snapshot -o name,used,referenced,creation -s creation</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">NAME                                                                                                   USED     REFER  CREATION</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool/var/lib/docker/3e29124aabd26aba9a987fa9baf73a49d20fd093693c6e1702892592c3a37df0@823949492          8K     19,1M  sáb may 22 14:24 2021</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool/var/lib/docker/ab44a150516267a349d9ec51eba4d5a4c62402e2984d1f976f9185f82457593d@346481945          0B     5,82M  sáb may 22 14:24 2021</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool/var/lib/docker/c67ae3e336110d75a53dc55cd0d6ac9bfc9eb10c62bfb1acda5e82cec9d4f503@974426951          8K     19,1M  sáb may 22 14:24 2021</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool/var/lib/docker/67bf0b89ec0abf78304fff424b3a5d839356e309a4ebc900991aa05082aae4e5-init@503730378     8K     74,4M  sáb may 22 17:44 2021</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool/var/lib/docker/b88682c070dc9cb7fa79451620d9adb3281995dd1a547701f7e0ddffb5c71864@344154902          8K     74,4M  sáb may 22 17:44 2021</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool/var/lib/docker/8b32028a0333569ade96213ad354021f246aad5577d6191fb907b597aebf8c6f@926970671          8K     28,7M  sáb may 22 17:54 2021</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool/var/lib/docker/bc80234cff605bb8bd3959e7c707359286692afda5de90d2f02d19032d20cefa@63021450           8K     5,83M  sáb may 22 17:54 2021</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool/var/lib/docker/df2e8b21e07f2b5f166477c3f965649c49042cc7c05ae5b5264963cb678edb9b@769644899          8K     28,7M  sáb may 22 17:54 2021</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool/var/lib/docker/f13856143025fcd4b664d9df7e13ae7e0f4b6d5ad2b3127bb4121a857da5c562@259540872          8K     7,26M  sáb may 22 17:54 2021</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool/var/lib/docker/b83cf8fb8f07d0b27025c294d6ac6962b82836c441620d489cc4dad1c5d5ccf2@376293604       2,44M     35,8M  sáb may 22 17:54 2021</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=delete-snapshots>Delete snapshots<a href=#delete-snapshots class=hash-link aria-label="Direct link to Delete snapshots" title="Direct link to Delete snapshots">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=samples-1>Samples<a href=#samples-1 class=hash-link aria-label="Direct link to Samples" title="Direct link to Samples">​</a></h4>
<ul>
<li>Delete last snapshot:</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">zfs list -H -t snapshot -o name -S creation -r bpool | tail -5 | xargs -n 1 zfs destroy</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=references-1>References<a href=#references-1 class=hash-link aria-label="Direct link to References" title="Direct link to References">​</a></h4>
<ul>
<li><a href=https://techblog.jeppson.org/2018/03/zfs-delete-oldest-n-snapshots/ target=_blank rel="noopener noreferrer">ZFS delete oldest n snapshots</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=list-pools>List pools<a href=#list-pools class=hash-link aria-label="Direct link to List pools" title="Direct link to List pools">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=user-data-pool>User data pool<a href=#user-data-pool class=hash-link aria-label="Direct link to User data pool" title="Direct link to User data pool">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">zfs list -r -t snapshot -o name,used,referenced,creation -s creation rpool/USERDATA</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=boot-pool>Boot pool<a href=#boot-pool class=hash-link aria-label="Direct link to Boot pool" title="Direct link to Boot pool">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">zfs list -r -t snapshot -o name,used,referenced,creation -s creation bpool/BOOT</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=list-zfs-system-root-space>List ZFS System Root space<a href=#list-zfs-system-root-space class=hash-link aria-label="Direct link to List ZFS System Root space" title="Direct link to List ZFS System Root space">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">zfs list -ro space rpool/ROOT</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=list-zfs-bpool-boot-space>List ZFS bpool BOOT space<a href=#list-zfs-bpool-boot-space class=hash-link aria-label="Direct link to List ZFS bpool BOOT space" title="Direct link to List ZFS bpool BOOT space">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">zfs list -ro space bpool/BOOT</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=list-zfs-userdata-space>List ZFS USERDATA space<a href=#list-zfs-userdata-space class=hash-link aria-label="Direct link to List ZFS USERDATA space" title="Direct link to List ZFS USERDATA space">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">zfs list -ro space rpool/USERDATA</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=list-zfs-varlibdocker-space>List ZFS /var/lib/docker space<a href=#list-zfs-varlibdocker-space class=hash-link aria-label="Direct link to List ZFS /var/lib/docker space" title="Direct link to List ZFS /var/lib/docker space">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">zfs list -ro space rpool/var/lib/docker</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=get-read-and-write-stats-from-pool>Get read and write stats from pool<a href=#get-read-and-write-stats-from-pool class=hash-link aria-label="Direct link to Get read and write stats from pool" title="Direct link to Get read and write stats from pool">​</a></h2>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">zpool iostat {{ pool_name }} {{ refresh_time_in_seconds }}</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=states>States<a href=#states class=hash-link aria-label="Direct link to States" title="Direct link to States">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=remove-user-state>Remove user state<a href=#remove-user-state class=hash-link aria-label="Direct link to Remove user state" title="Direct link to Remove user state">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">$ zsysctl show --full |grep r48a3r</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$ zsysctl state remove r48a3r</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool/USERDATA/sdelrio_0y06wn@autozsys_r48a3r will be detached from system state rpool/ROOT/ubuntu_awq93l@autozsys_r48a3r</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=remove-system-wide-state>Remove system wide state<a href=#remove-system-wide-state class=hash-link aria-label="Direct link to Remove system wide state" title="Direct link to Remove system wide state">​</a></h3>
<p>Whole system removing adding <code>--system</code> (<code>/boot</code> included)</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">$ sudo zsysctl state remove r48a3r --system</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=user-state-without-any-dependency-but-linked-to-a-system-state>User State without any dependency but linked to a system state<a href=#user-state-without-any-dependency-but-linked-to-a-system-state class=hash-link aria-label="Direct link to User State without any dependency but linked to a system state" title="Direct link to User State without any dependency but linked to a system state">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">$ zsysctl state remove rpool/USERDATA/didrocks_e2jj0s@autozsys_iynia9</span><br></span><span class=token-line style=color:#393A34><span class="token plain">rpool/USERDATA/didrocks_e2jj0s@autozsys_iynia9 will be detached from system state rpool/ROOT/ubuntu_qiq15o@autozsys_iynia9</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">Would you like to proceed [y/N]? y</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=encryption>Encryption<a href=#encryption class=hash-link aria-label="Direct link to Encryption" title="Direct link to Encryption">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=create-and-load-key>Create and load-key<a href=#create-and-load-key class=hash-link aria-label="Direct link to Create and load-key" title="Direct link to Create and load-key">​</a></h3>
<p>Sample, create a vol with compression, encryption, and dedup.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">zpool create -o ashift=12 -m /mnt/zfs zfs raidz sdb sdc sde</span><br></span><span class=token-line style=color:#393A34><span class="token plain">zfs set compression=lz4 zfs</span><br></span><span class=token-line style=color:#393A34><span class="token plain">zfs set xattr=sa zfs</span><br></span><span class=token-line style=color:#393A34><span class="token plain">zfs set atime=off zfs</span><br></span><span class=token-line style=color:#393A34><span class="token plain">zfs set dedup=on zfs</span><br></span><span class=token-line style=color:#393A34><span class="token plain">zfs set recordsize=1M zfs</span><br></span><span class=token-line style=color:#393A34><span class="token plain">zfs create -o encryption=aes-256-gcm -o keyformat=passphrase -o keylocation=file:///boot/config/zfs.key zfs/homes</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">zfs load-key zfs/homes</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=key-status>Key status<a href=#key-status class=hash-link aria-label="Direct link to Key status" title="Direct link to Key status">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">zfs get keystatus [dataset](dataset)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=changing-wrapping-key>Changing wrapping key<a href=#changing-wrapping-key class=hash-link aria-label="Direct link to Changing wrapping key" title="Direct link to Changing wrapping key">​</a></h3>
<p>Change a wrapping key for a dataset as long as current wrapping key is loaded (<code>zfs get keystatus [dataset](dataset)</code>)</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">zfs key -c [dataset](dataset)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=change-actual-data-encryption-key>Change actual data encryption key<a href=#change-actual-data-encryption-key class=hash-link aria-label="Direct link to Change actual data encryption key" title="Direct link to Change actual data encryption key">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">zfs key -K [dataset](dataset)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<ul>
<li><a href=https://www.reddit.com/r/zfs/comments/7mm237/changing_passphrase_on_encrypted_zpool/ target=_blank rel="noopener noreferrer">Changing passphrase on encrypted zpool</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=change-key-location>Change key location<a href=#change-key-location class=hash-link aria-label="Direct link to Change key location" title="Direct link to Change key location">​</a></h3>
<p>You can use password prompt as the encryption key unlocking method.
And it can be godo good. But if want to automate this, you can put the key to be read from USB drive.</p>
<p>To do that one can simply prepare a new key and point the pool toward it.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">dd if=/dev/urandom of=/usb/key.dat bs=32 count=1</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">zfs change-key -o keylocation=file:///usb/key.dat -o keyformat=raw pool-name</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>To rollback to password prompt:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">zfs change-key -o keylocation=prompt -o keyformat=passphrase pool-name</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=encrypted-root>Encrypted Root<a href=#encrypted-root class=hash-link aria-label="Direct link to Encrypted Root" title="Direct link to Encrypted Root">​</a></h3>
<ul>
<li><a href=https://www.medo64.com/2020/07/encrypted-zfs-root-on-ubuntu-server-20-04-via-usb-unlock/ target=_blank rel="noopener noreferrer">Encypted ZFS Root with USB Unlock</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=sharing-zfs-datasets>Sharing ZFS Datasets<a href=#sharing-zfs-datasets class=hash-link aria-label="Direct link to Sharing ZFS Datasets" title="Direct link to Sharing ZFS Datasets">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=nfs>NFS<a href=#nfs class=hash-link aria-label="Direct link to NFS" title="Direct link to NFS">​</a></h3>
<ol>
<li>Install <code>nfs-kernel-server</code></li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">sudo apt-get install -y nfs-kernel-server</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<ol start=2>
<li>Enable <code>sharenfs</code> on the dataset</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">zfs set sharenfs=on pool-name/dataset-name</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<ol start=3>
<li>Now you can mount in your NFS client</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">mount -t nfs \</span><br></span><span class=token-line style=color:#393A34><span class="token plain">zfs.host.com:/pool-name/dataset-name \</span><br></span><span class=token-line style=color:#393A34><span class="token plain">/path/to/local/mount</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<ul>
<li><a href=https://blog.programster.org/sharing-zfs-datasets-via-nfs target=_blank rel="noopener noreferrer">Sharing ZFS Dataset via NFS</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=comression>Comression<a href=#comression class=hash-link aria-label="Direct link to Comression" title="Direct link to Comression">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=speed-benchmarks>Speed benchmarks<a href=#speed-benchmarks class=hash-link aria-label="Direct link to Speed benchmarks" title="Direct link to Speed benchmarks">​</a></h3>
<p>Since LZ4 is the fastest decompression depending on the usage we may be internested in another other method or compression level:</p>
<ul>
<li>Zstd and LZ4: <a href=https://indico.fnal.gov/event/16264/contributions/36466/attachments/22610/28037/Zstd__LZ4.pdf target=_blank rel="noopener noreferrer">https://indico.fnal.gov/event/16264/contributions/36466/attachments/22610/28037/Zstd__LZ4.pdf</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=ui>UI<a href=#ui class=hash-link aria-label="Direct link to UI" title="Direct link to UI">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=cockpit>Cockpit<a href=#cockpit class=hash-link aria-label="Direct link to Cockpit" title="Direct link to Cockpit">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">apt install cockpit</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=backup>Backup<a href=#backup class=hash-link aria-label="Direct link to Backup" title="Direct link to Backup">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=pyznap>Pyznap<a href=#pyznap class=hash-link aria-label="Direct link to Pyznap" title="Direct link to Pyznap">​</a></h3>
<p>ZFS snapshot tool written in python</p>
<p><code>pyznap</code> is a ZFS snapshot management tool. It automatically takes and deletes snapshots and can send them to different backup locations. You can specify a policy for a given filesystem in the <code>pyznap.conf</code> file and then use cron to let it run regularly.</p>
<ul>
<li><a href=https://github.com/yboetz/pyznap target=_blank rel="noopener noreferrer">GitHub</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=zfsbackup-go>ZFSbackup-go<a href=#zfsbackup-go class=hash-link aria-label="Direct link to ZFSbackup-go" title="Direct link to ZFSbackup-go">​</a></h3>
<p>Backup ZFS snapshots to cloud storage such as Google, Amazon, Azure, etc. Built with the enterprise in mind.</p>
<ul>
<li><a href=https://github.com/someone1/zfsbackup-go target=_blank rel="noopener noreferrer">GitHub</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=zrepl>Zrepl<a href=#zrepl class=hash-link aria-label="Direct link to Zrepl" title="Direct link to Zrepl">​</a></h3>
<p>One-stop ZFS backup & replication solution</p>
<ul>
<li><a href=https://github.com/zrepl/zrepl target=_blank rel="noopener noreferrer">GitHub</a></li>
<li><a href=https://zrepl.github.io0 target=_blank rel="noopener noreferrer">Doc</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=docker>Docker<a href=#docker class=hash-link aria-label="Direct link to Docker" title="Direct link to Docker">​</a></h3>
<p>Docker sometimes have overlay fs issues when using ZFS as volume storage, for example in k3s or k3d, you can override the docker volume to use zfs mounting a volume in ext4:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">$ zfs create -s -V 50GB rpool/ROOT/docker</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$ mkfs.ext4 /dev/zvol/rpool/ROOT/docker </span><br></span><span class=token-line style=color:#393A34><span class="token plain">$ echo "/dev/zvol/rpool/ROOT/docker /var/lib/docker ext4 defaults 0 0" >> /etc/fstab</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>References:</p>
<ul>
<li><a href=https://github.com/k3s-io/k3s/issues/1688#issuecomment-619570374 target=_blank rel="noopener noreferrer">https://github.com/k3s-io/k3s/issues/1688#issuecomment-619570374</a></li>
<li><a href=https://www.enricobassetti.it/2022/02/k3s-zfs-cgroups-v2/ target=_blank rel="noopener noreferrer">https://www.enricobassetti.it/2022/02/k3s-zfs-cgroups-v2/</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=resources>Resources<a href=#resources class=hash-link aria-label="Direct link to Resources" title="Direct link to Resources">​</a></h2>
<ul>
<li><a href=https://blog.programster.org/zfs-cheatsheet target=_blank rel="noopener noreferrer">ZFS-Cheatsheet</a></li>
<li><a href=https://wiki.debian.org/ZFS#Provisioning_file_systems_or_volume target=_blank rel="noopener noreferrer">Debian Wiki</a>
<ul>
<li><a href=https://wiki.debian.org/ZFS#Provisioning_file_systems_or_volume target=_blank rel="noopener noreferrer">Provision filesystem or volume (ZVOL)</a></li>
</ul>
</li>
<li><a href=https://linuxconfig.org/configuring-zfs-on-ubuntu-20-04 target=_blank rel="noopener noreferrer">Configure ZFS on Ubuntu 20.04</a></li>
<li><a href="https://www.youtube.com/watch?v=l-iu-cutkyQ" target=_blank rel="noopener noreferrer">2020: Video - Running Ubuntu 20.04 on ZFS</a></li>
<li><a href=https://openzfs.github.io/openzfs-docs/Getting%20Started/Ubuntu/Ubuntu%2020.04%20Root%20on%20ZFS.html target=_blank rel="noopener noreferrer">Ubuntu 20.04 Root on ZFS</a></li>
<li><a href=https://linsomniac.gitlab.io/post/2020-04-09-ubuntu-2004-encrypted-zfs/ target=_blank rel="noopener noreferrer">Encrypting ZFS on Ubuntu 20.04</a></li>
<li><a href=/docs/OS/GNU-Linux/ZFS/zsys>Zsys</a></li>
<li><a href=http://zfsonlinux.org/ target=_blank rel="noopener noreferrer">ZFS on linux </a></li>
<li><a href=http://zfsguru.com/ target=_blank rel="noopener noreferrer">FreeBSD ZFS guru</a></li>
<li><a href=https://forums.unraid.net/topic/41333-zfs-plugin-for-unraid/ target=_blank rel="noopener noreferrer">ZFS Plugin for Unraid</a></li>
<li><a href="https://sysops.tv/?page_id=28" target=_blank rel="noopener noreferrer">NAS with ZFS on RAspberry Pi 4</a></li>
<li><a href=https://rudd-o.com/linux-and-free-software/tip-letting-your-zfs-pool-sleep target=_blank rel="noopener noreferrer">Letting your ZFS pool sleep</a></li>
<li><a href=https://www.medo64.com/2020/12/changing-zfs-key-location/ target=_blank rel="noopener noreferrer">Changing ZFS Key Location</a></li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-tags-row"><div class=col><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class=tag_QGVx><a class="tag_zVej tagRegular_sFm0" href=/docs/tags/zfs>zfs</a><li class=tag_QGVx><a class="tag_zVej tagRegular_sFm0" href=/docs/tags/zpool>zpool</a><li class=tag_QGVx><a class="tag_zVej tagRegular_sFm0" href=/docs/tags/gc>gc</a></ul></div></div><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class=col><a href=https://github.com/sdelrio/golden-forest/edit/master/docs/OS/GNU-Linux/ZFS/zfs.md target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_Z9Sw aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/docs/OS/GNU-Linux/TrueNAS/truenas-scripts><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>TrueNAS SCALE scripts</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/docs/OS/GNU-Linux/ZFS/zsys><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>ZSysctl</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#instal-linux-mint-20-with-zfs class="table-of-contents__link toc-highlight">Instal Linux Mint 20 with ZFS</a><li><a href=#mount class="table-of-contents__link toc-highlight">Mount</a><ul><li><a href=#mounts-external-disk-share class="table-of-contents__link toc-highlight">mounts external disk share</a><li><a href=#import-a-pool-as-readonly class="table-of-contents__link toc-highlight">Import a pool as readonly</a><li><a href=#mount-a-zfs-snapshot-in-a-directory-as-readonly class="table-of-contents__link toc-highlight">Mount a ZFS snapshot in a directory as readonly</a></ul><li><a href=#pool class="table-of-contents__link toc-highlight">Pool</a><ul><li><a href=#create class="table-of-contents__link toc-highlight">Create</a><li><a href=#list class="table-of-contents__link toc-highlight">List</a><li><a href=#cache-zilarc class="table-of-contents__link toc-highlight">Cache (ZIL/ARC)</a><li><a href=#upgrade-zpool class="table-of-contents__link toc-highlight">Upgrade zpool</a></ul><li><a href=#zfs-filesystem-or-volumes-zvol class="table-of-contents__link toc-highlight">ZFS Filesystem or volumes (ZVOL)</a><ul><li><a href=#create-1 class="table-of-contents__link toc-highlight">Create</a><li><a href=#samples class="table-of-contents__link toc-highlight">Samples</a><li><a href=#list-volumes class="table-of-contents__link toc-highlight">List Volumes</a></ul><li><a href=#snapshots class="table-of-contents__link toc-highlight">Snapshots</a><ul><li><a href=#tools class="table-of-contents__link toc-highlight">Tools</a><li><a href=#list-snapshots-standard class="table-of-contents__link toc-highlight">List snapshots (standard)</a><li><a href=#list-snapshots-detailed class="table-of-contents__link toc-highlight">List snapshots (detailed)</a><li><a href=#delete-snapshots class="table-of-contents__link toc-highlight">Delete snapshots</a></ul><li><a href=#list-pools class="table-of-contents__link toc-highlight">List pools</a><ul><li><a href=#user-data-pool class="table-of-contents__link toc-highlight">User data pool</a><li><a href=#boot-pool class="table-of-contents__link toc-highlight">Boot pool</a><li><a href=#list-zfs-system-root-space class="table-of-contents__link toc-highlight">List ZFS System Root space</a><li><a href=#list-zfs-bpool-boot-space class="table-of-contents__link toc-highlight">List ZFS bpool BOOT space</a><li><a href=#list-zfs-userdata-space class="table-of-contents__link toc-highlight">List ZFS USERDATA space</a><li><a href=#list-zfs-varlibdocker-space class="table-of-contents__link toc-highlight">List ZFS /var/lib/docker space</a></ul><li><a href=#get-read-and-write-stats-from-pool class="table-of-contents__link toc-highlight">Get read and write stats from pool</a><li><a href=#states class="table-of-contents__link toc-highlight">States</a><ul><li><a href=#remove-user-state class="table-of-contents__link toc-highlight">Remove user state</a><li><a href=#remove-system-wide-state class="table-of-contents__link toc-highlight">Remove system wide state</a><li><a href=#user-state-without-any-dependency-but-linked-to-a-system-state class="table-of-contents__link toc-highlight">User State without any dependency but linked to a system state</a></ul><li><a href=#encryption class="table-of-contents__link toc-highlight">Encryption</a><ul><li><a href=#create-and-load-key class="table-of-contents__link toc-highlight">Create and load-key</a><li><a href=#key-status class="table-of-contents__link toc-highlight">Key status</a><li><a href=#changing-wrapping-key class="table-of-contents__link toc-highlight">Changing wrapping key</a><li><a href=#change-actual-data-encryption-key class="table-of-contents__link toc-highlight">Change actual data encryption key</a><li><a href=#change-key-location class="table-of-contents__link toc-highlight">Change key location</a><li><a href=#encrypted-root class="table-of-contents__link toc-highlight">Encrypted Root</a></ul><li><a href=#sharing-zfs-datasets class="table-of-contents__link toc-highlight">Sharing ZFS Datasets</a><ul><li><a href=#nfs class="table-of-contents__link toc-highlight">NFS</a></ul><li><a href=#comression class="table-of-contents__link toc-highlight">Comression</a><ul><li><a href=#speed-benchmarks class="table-of-contents__link toc-highlight">Speed benchmarks</a></ul><li><a href=#ui class="table-of-contents__link toc-highlight">UI</a><ul><li><a href=#cockpit class="table-of-contents__link toc-highlight">Cockpit</a></ul><li><a href=#backup class="table-of-contents__link toc-highlight">Backup</a><ul><li><a href=#pyznap class="table-of-contents__link toc-highlight">Pyznap</a><li><a href=#zfsbackup-go class="table-of-contents__link toc-highlight">ZFSbackup-go</a><li><a href=#zrepl class="table-of-contents__link toc-highlight">Zrepl</a><li><a href=#docker class="table-of-contents__link toc-highlight">Docker</a></ul><li><a href=#resources class="table-of-contents__link toc-highlight">Resources</a></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class=footer__title>Docs</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/docs/docs-intro>Tutorial</a></ul></div><div class="col footer__col"><div class=footer__title>Community</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://github.com/sdelrio/golden-forest target=_blank rel="noopener noreferrer" class=footer__link-item>GitHub<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a></ul></div><div class="col footer__col"><div class=footer__title>More</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/blog>Blog</a></ul></div></div><div class="footer__bottom text--center"><div class=footer__copyright>Copyright © 2025 The Golden Forest project. Built with Docusaurus.</div></div></div></footer></div>