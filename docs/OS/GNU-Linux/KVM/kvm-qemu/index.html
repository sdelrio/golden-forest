<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-OS/GNU-Linux/KVM/kvm-qemu" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.7.0"><title data-rh=true>QEMU | The Golden Forest</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:image content=https://www.lorien.cloud/img/docusaurus-social-card.jpg><meta data-rh=true name=twitter:image content=https://www.lorien.cloud/img/docusaurus-social-card.jpg><meta data-rh=true property=og:url content=https://www.lorien.cloud/docs/OS/GNU-Linux/KVM/kvm-qemu><meta data-rh=true property=og:locale content=en><meta data-rh=true name=docusaurus_locale content=en><meta data-rh=true name=docsearch:language content=en><meta data-rh=true name=docusaurus_version content=current><meta data-rh=true name=docusaurus_tag content=docs-default-current><meta data-rh=true name=docsearch:version content=current><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current><meta data-rh=true property=og:title content="QEMU | The Golden Forest"><meta data-rh=true name=description content="KVM UI managers"><meta data-rh=true property=og:description content="KVM UI managers"><link data-rh=true rel=icon href=/img/favicon.ico><link data-rh=true rel=canonical href=https://www.lorien.cloud/docs/OS/GNU-Linux/KVM/kvm-qemu><link data-rh=true rel=alternate href=https://www.lorien.cloud/docs/OS/GNU-Linux/KVM/kvm-qemu hreflang=en><link data-rh=true rel=alternate href=https://www.lorien.cloud/docs/OS/GNU-Linux/KVM/kvm-qemu hreflang=x-default><link data-rh=true rel=preconnect href=https://5VR022LUD5-dsn.algolia.net crossorigin=anonymous><link rel=alternate type=application/rss+xml href=/blog/rss.xml title="The Golden Forest RSS Feed"><link rel=alternate type=application/atom+xml href=/blog/atom.xml title="The Golden Forest Atom Feed"><link rel=search type=application/opensearchdescription+xml title="The Golden Forest" href=/opensearch.xml><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css type=text/css integrity=sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM crossorigin=anonymous><link rel=stylesheet href=/assets/css/styles.58681d6d.css><script src=/assets/js/runtime~main.ce8435f9.js defer></script><script src=/assets/js/main.14a37261.js defer></script><body class=navigation-with-keyboard><script>!function(){var t,e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t=null!==e?e:"light",document.documentElement.setAttribute("data-theme",t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><link rel=preload as=image href=/img/logo.svg><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="navbar navbar--fixed-top"><div class=navbar__inner><div class=navbar__items><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/><div class=navbar__logo><img src=/img/logo.svg alt=Logo class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/img/logo.svg alt=Logo class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">The Golden Forest</b></a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/docs/docs-intro>IT</a><a class="navbar__item navbar__link" docid=tutorial-intro href=/tutorial/tutorial-intro>Add content</a><a class="navbar__item navbar__link" href=/blog>Blog</a></div><div class="navbar__items navbar__items--right"><a href=https://github.com/sdelrio/golden-forest target=_blank rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live=polite aria-pressed=false><svg viewBox="0 0 24 24" width=24 height=24 class=lightToggleIcon_pyhR><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 class=darkToggleIcon_wfgR><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg></button></div><div class=navbarSearchContainer_Bca1><button type=button class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 20 20" aria-hidden=true><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke=currentColor fill=none fill-rule=evenodd stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>Search</span></span><span class=DocSearch-Button-Keys></span></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class=sidebar_njMd><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/docs/docs-intro>Introduction</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/Backup/borg>Backup</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/category/cloud-infrastructure>Cloud Infrastructure</a><button aria-label="Expand sidebar category 'Cloud Infrastructure'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/category/cloud-platform>Cloud Platform</a><button aria-label="Expand sidebar category 'Cloud Platform'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/category/coding>Coding</a><button aria-label="Expand sidebar category 'Coding'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/Containers/>Containers</a><button aria-label="Expand sidebar category 'Containers'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/DevOps/>DevOps</a><button aria-label="Expand sidebar category 'DevOps'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/Domotic/>Domotic</a><button aria-label="Expand sidebar category 'Domotic'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/category/dnd>Games</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/Hardware/CPU/coolers>Hardware</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/HomeLab/Raspberry-Pi/>HomeLab</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/Multimedia/BDSup2Sub>Multimedia</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/Networking/>Networking</a><button aria-label="Expand sidebar category 'Networking'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" href=/docs/category/operative-systems>Operative Systems</a><button aria-label="Collapse sidebar category 'Operative Systems'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role=button aria-expanded=true tabindex=0 href=/docs/OS/GNU-Linux/Drivers/AMD/radeon>GNU-Linux</a></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/OS/GNU-Linux/Drivers/AMD/radeon>Drivers</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/OS/GNU-Linux/HDs/smart>HDs</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/OS/GNU-Linux/Hardware/CPU/Benchmarks/7zip>Hardware</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role=button aria-expanded=true tabindex=0 href=/docs/OS/GNU-Linux/KVM/kvm-qemu>KVM</a></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/docs/OS/GNU-Linux/KVM/kvm-qemu>QEMU</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/OS/GNU-Linux/KVM/kvm-quickemu>Quickemu</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/OS/GNU-Linux/Kernel/linux-5.15>Kernel</a></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/OS/GNU-Linux/Makefile>Makefile</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/OS/GNU-Linux/Networking/traceroute>Networking</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/OS/GNU-Linux/NixOS/flakes>NixOS</a></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/OS/GNU-Linux/PXE>PXE boot</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/docs/OS/GNU-Linux/TrueNAS/>TrueNAS</a><button aria-label="Expand sidebar category 'TrueNAS'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/docs/OS/GNU-Linux/ZFS/>ZFS</a><button aria-label="Expand sidebar category 'ZFS'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/OS/GNU-Linux/automatic-upgrades>Automatic Upgrades</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/OS/GNU-Linux/clean-system>Clean system</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/OS/GNU-Linux/disk-caching-and-performance>Disk Caching & Performance</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/OS/GNU-Linux/netplan>Netplan</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/OS/GNU-Linux/resolved>Systemd-resolved</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/OS/GNU-Linux/ssh>ssh client</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/OS/GNU-Linux/syslog>Syslog</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/OS/GNU-Linux/wm>Window Managers</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/OS/MacOS/i3-tiling-macos>MacOS</a></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/OS/Nix/>Nix</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/OS/Windows/WSL/nix-configs>Windows</a></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/OS/imaging-tools>Imaging and Cloning tools</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/category/quality-assurance>Quality Assurance</a><button aria-label="Expand sidebar category 'Quality Assurance'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/Security/owasp>Security</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/Shell-Script/bash-unit-testing>Shell & Scripts</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/Software/Backup/duplicati>Software</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/Software-Architecture/microservices>Software-Architecture</a></div></ul></nav></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs itemscope itemtype=https://schema.org/BreadcrumbList><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/docs/category/operative-systems><span itemprop=name>Operative Systems</span></a><meta itemprop=position content=1><li class=breadcrumbs__item><span class=breadcrumbs__link>GNU-Linux</span><meta itemprop=position content=2><li class=breadcrumbs__item><span class=breadcrumbs__link>KVM</span><meta itemprop=position content=3><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link itemprop=name>QEMU</span><meta itemprop=position content=4></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>QEMU</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=kvm-ui-managers>KVM UI managers<a href=#kvm-ui-managers class=hash-link aria-label="Direct link to KVM UI managers" title="Direct link to KVM UI managers">​</a></h2>
<ul>
<li><a href=https://github.com/kimchi-project/kimchi/ target=_blank rel="noopener noreferrer">Kimchi: HTML5 management interface</a></li>
<li><a href=https://virt-manager.org/ target=_blank rel="noopener noreferrer">vir-manager: desktop app availabe in most distributions</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=qemuconf>qemu.conf<a href=#qemuconf class=hash-link aria-label="Direct link to qemu.conf" title="Direct link to qemu.conf">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=uefi-bios>UEFI BIOS<a href=#uefi-bios class=hash-link aria-label="Direct link to UEFI BIOS" title="Direct link to UEFI BIOS">​</a></h3>
<p>To enable UEFI bios override (VGA passwthrough and others). Uncomment the <code>nvram</code> config.</p>
<ul>
<li><code>/etc/libvirt/qemu.conf</code></li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"># Later, when libvirt creates per domain variable store, this list is</span><br></span><span class=token-line style=color:#393A34><span class="token plain"># searched for the master image. The UEFI firmware can be called</span><br></span><span class=token-line style=color:#393A34><span class="token plain"># differently for different guest architectures. For instance, it's OVMF</span><br></span><span class=token-line style=color:#393A34><span class="token plain"># for x86_64 and i686, but it's AAVMF for aarch64. The libvirt default</span><br></span><span class=token-line style=color:#393A34><span class="token plain"># follows this scheme.</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">nvram = [</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   "/usr/share/OVMF/OVMF_CODE.fd:/usr/share/OVMF/OVMF_VARS.fd",</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   "/usr/share/OVMF/OVMF_CODE.secboot.fd:/usr/share/OVMF/OVMF_VARS.fd",</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   "/usr/share/AAVMF/AAVMF_CODE.fd:/usr/share/AAVMF/AAVMF_VARS.fd",</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   "/usr/share/AAVMF/AAVMF32_CODE.fd:/usr/share/AAVMF/AAVMF32_VARS.fd",</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   "/usr/share/OVMF/OVMF_CODE.ms.fd:/usr/share/OVMF/OVMF_VARS.ms.fd"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">]</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=disable-security>Disable security<a href=#disable-security class=hash-link aria-label="Direct link to Disable security" title="Direct link to Disable security">​</a></h4>
<p>Set <code>security_driver = "none"</code> if you need some special privilege, like VGA or USB passthrough.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=console>Console<a href=#console class=hash-link aria-label="Direct link to Console" title="Direct link to Console">​</a></h4>
<ul>
<li>Enter into a folder and boot efi manually:</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">FS1:</span><br></span><span class=token-line style=color:#393A34><span class="token plain">cd EFI</span><br></span><span class=token-line style=color:#393A34><span class="token plain">cd boot</span><br></span><span class=token-line style=color:#393A34><span class="token plain">bootx64.efi</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<ul>
<li>Set manually a boot file on startup:</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">echo \EFI\boot\bootx64.efi > \startup.nsh</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=virtio-win-isos>virtio-win isos<a href=#virtio-win-isos class=hash-link aria-label="Direct link to virtio-win isos" title="Direct link to virtio-win isos">​</a></h2>
<ul>
<li><a href=https://fedorapeople.org/groups/virt/virtio-win/direct-downloads/archive-virtio/ target=_blank rel="noopener noreferrer">https://fedorapeople.org/groups/virt/virtio-win/direct-downloads/archive-virtio/</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=virtio-fs>virtio-fs<a href=#virtio-fs class=hash-link aria-label="Direct link to virtio-fs" title="Direct link to virtio-fs">​</a></h2>
<p>Virtiofs is a shared file system that lets virtual machines access a directory tree on the host. Unlike existing approaches, it is designed to offer local file system semantics and performance.</p>
<ul>
<li><a href=https://virtio-fs.gitlab.io/ target=_blank rel="noopener noreferrer">https://virtio-fs.gitlab.io/</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=requirements>Requirements<a href=#requirements class=hash-link aria-label="Direct link to Requirements" title="Direct link to Requirements">​</a></h3>
<ul>
<li>Linux 5.4</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">$ uname -rv</span><br></span><span class=token-line style=color:#393A34><span class="token plain">5.4.0-90-generic #101-Ubuntu SMP Fri Oct 15 20:00:55 UTC 2021</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<ul>
<li>QEMU 5.0</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">$ qemu-aarch64_be-static --version</span><br></span><span class=token-line style=color:#393A34><span class="token plain">qemu-aarch64_be version 5.0.0 (Debian 1:5.0-5ubuntu6~ppa0)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">Copyright (c) 2003-2020 Fabrice Bellard and the QEMU Project developers</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<ul>
<li>libvirt 6.2+ (in my case i got 6.6.0)</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">$ libvirtd -V</span><br></span><span class=token-line style=color:#393A34><span class="token plain">libvirtd (libvirt) 6.6.0</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<ul>
<li><code>memory_backend_dir</code> enabled on libvirt.conf</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">grep memory_backing_dir /etc/libvirt/qemu.conf</span><br></span><span class=token-line style=color:#393A34><span class="token plain">memory_backing_dir = "/var/lib/libvirt/qemu/ram"</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=ubuntu-2004>Ubuntu 20.04<a href=#ubuntu-2004 class=hash-link aria-label="Direct link to Ubuntu 20.04" title="Direct link to Ubuntu 20.04">​</a></h4>
<p>QEMU 5.0, libvirt 6.6, virtmanager 3.0, are available for Ubuntu 20.04:</p>
<ul>
<li><a href="https://launchpad.net/~jacob/+archive/ubuntu/virtualisation?field.series_filter=focal" target=_blank rel="noopener noreferrer">https://launchpad.net/~jacob/+archive/ubuntu/virtualisation?field.series_filter=focal</a></li>
</ul>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id=cli-install>CLI install<a href=#cli-install class=hash-link aria-label="Direct link to CLI install" title="Direct link to CLI install">​</a></h5>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">sudo add-apt-repository ppa:jacob/virtualisation</span><br></span><span class=token-line style=color:#393A34><span class="token plain">sudo apt-get update</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id=ansible-install>Ansible install<a href=#ansible-install class=hash-link aria-label="Direct link to Ansible install" title="Direct link to Ansible install">​</a></h5>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token punctuation" style=color:#393A34>-</span><span class="token plain"> </span><span class="token key atrule" style=color:#00a4db>name</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Add Jacob Zimmermann APT repo"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token key atrule" style=color:#00a4db>apt_repository</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token key atrule" style=color:#00a4db>repo</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> ppa</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain">jacob/virtualisation</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token key atrule" style=color:#00a4db>state</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> present</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token key atrule" style=color:#00a4db>codename</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> focal</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain"> </span><span class="token key atrule" style=color:#00a4db>name</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"APT VM packages"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token key atrule" style=color:#00a4db>apt</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token key atrule" style=color:#00a4db>name</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain"> qemu</span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain">kvm</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain"> qemu</span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain">utils</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain"> libvirt</span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain">daemon</span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain">system</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain"> libvirt</span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain">clients</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain"> virt</span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain">manager</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain"> ovmf</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain"> libhugetlbfs</span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain">bin      </span><span class="token comment" style=color:#999988;font-style:italic># hugeadm: Tools to ease use of hugetlbfs</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=cpu-section-with-numa>CPU section with NUMA<a href=#cpu-section-with-numa class=hash-link aria-label="Direct link to CPU section with NUMA" title="Direct link to CPU section with NUMA">​</a></h3>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">  [cpu mode="host-model" check="none"](cpu mode="host-model" check="none")</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    [topology sockets="1" dies="1" cores="6" threads="2"/](topology sockets="1" dies="1" cores="6" threads="2"/)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    [numa](numa)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      [cell id="0" cpus="0-11" memory="16" unit="GiB" memAccess="shared"/](cell id="0" cpus="0-11" memory="16" unit="GiB" memAccess="shared"/)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    [/numa](/numa)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  [/cpu](/cpu)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=memorybacking-with-source-and-access>memoryBacking with source and access<a href=#memorybacking-with-source-and-access class=hash-link aria-label="Direct link to memoryBacking with source and access" title="Direct link to memoryBacking with source and access">​</a></h3>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">  [memoryBacking](memoryBacking)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    [hugepages/](hugepages/)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    [source type="memfd"/](source type="memfd"/)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    [access mode="shared"/](access mode="shared"/)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  [/memoryBacking](/memoryBacking)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=filesystem-with-virtiofs>filesystem with virtiofs<a href=#filesystem-with-virtiofs class=hash-link aria-label="Direct link to filesystem with virtiofs" title="Direct link to filesystem with virtiofs">​</a></h3>
<ul>
<li>source dir will be a path on the hots machine</li>
<li>target dir is the name of the mounted drive in the guest machine</li>
</ul>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">  [devices](devices)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   ...</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    [filesystem type="mount" accessmode="passthrough"](filesystem type="mount" accessmode="passthrough")</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      [driver type="virtiofs" queue="1024"/](driver type="virtiofs" queue="1024"/)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      [source dir="/hddpool/imagenes"/](source dir="/hddpool/imagenes"/)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      [target dir="mount_tag"/](target dir="mount_tag"/)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    [/filesystem](/filesystem)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   ...</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  [/devices](/devices)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=install-virtiofs-drivers-on-windows>Install virtiofs drivers on windows<a href=#install-virtiofs-drivers-on-windows class=hash-link aria-label="Direct link to Install virtiofs drivers on windows" title="Direct link to Install virtiofs drivers on windows">​</a></h3>
<ul>
<li><a href=https://virtio-fs.gitlab.io/howto-windows.html target=_blank rel="noopener noreferrer">How to install virtiofs drivers on windows</a></li>
</ul>
<ol>
<li>Install <a href=http://www.secfs.net/winfsp target=_blank rel="noopener noreferrer">WinFsp</a></li>
<li>Install virtiofs PCI device driver: Device manager, right click Mass storage device, use virtio-win ISO to install drivers</li>
<li>Copy <code>E:\viofs\w10\amd64</code> (E drive is your virtio-win ISO drivers) to a local location (sample <code>C:\virtiofs</code>).</li>
<li>Install virtio service on windows (open terminal as administrator).</li>
</ol>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">sc.exe create VirtioFsSvc binpath="C:\virtiofs\virtiofs.exe" start=auto depend="WinFsp.Launcher/VirtioFsDrv" DisplayName="Virtio FS Service"</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<ol start=6>
<li>Start VirtioFsSvc (open terminal as administrator).</li>
</ol>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">sc.exe start VirtioFsSvc</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p><img decoding=async loading=lazy alt="virtiofs terminal" src=/assets/images/virtiofs-start-svc-728a7bd1aaca1d96f37bb239d62673de.png width=918 height=390 class=img_ev3q></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=pci-passthrough>PCI passthrough<a href=#pci-passthrough class=hash-link aria-label="Direct link to PCI passthrough" title="Direct link to PCI passthrough">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=check-if-is-amd_iommuon--amd_iommupt-enabled>Check if is <code>amd_iommu=on</code> & <code>amd_iommu=pt</code> enabled<a href=#check-if-is-amd_iommuon--amd_iommupt-enabled class=hash-link aria-label="Direct link to check-if-is-amd_iommuon--amd_iommupt-enabled" title="Direct link to check-if-is-amd_iommuon--amd_iommupt-enabled">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">$ dmesg | grep AMD-Vi</span><br></span><span class=token-line style=color:#393A34><span class="token plain">[    1.498933] pci 0000:00:00.2: AMD-Vi: IOMMU performance counters supported</span><br></span><span class=token-line style=color:#393A34><span class="token plain">[    1.503260] pci 0000:00:00.2: AMD-Vi: Found IOMMU cap 0x40</span><br></span><span class=token-line style=color:#393A34><span class="token plain">[    1.503261] pci 0000:00:00.2: AMD-Vi: Extended features (0x58f77ef22294ade):</span><br></span><span class=token-line style=color:#393A34><span class="token plain">[    1.503263] AMD-Vi: Interrupt remapping enabled</span><br></span><span class=token-line style=color:#393A34><span class="token plain">[    1.503263] AMD-Vi: Virtual APIC enabled</span><br></span><span class=token-line style=color:#393A34><span class="token plain">[    1.503263] AMD-Vi: X2APIC enabled</span><br></span><span class=token-line style=color:#393A34><span class="token plain">[    1.503333] AMD-Vi: Lazy IO/TLB flushing enabled</span><br></span><span class=token-line style=color:#393A34><span class="token plain">[    1.801913] AMD-Vi: AMD IOMMUv2 driver by Joerg Roedel [jroedel@suse.de](jroedel@suse.de)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$ lspci | grep VGA</span><br></span><span class=token-line style=color:#393A34><span class="token plain">09:00.0 VGA compatible controller: Advanced Micro Devices, Inc. [AMD/ATI] Ellesmere [Radeon RX 470/480/570/570X/580/580X/590] (rev cf)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$ lspci | grep VGA</span><br></span><span class=token-line style=color:#393A34><span class="token plain">09:00.0 VGA compatible controller: Advanced Micro Devices, Inc. [AMD/ATI] Ellesmere [Radeon RX 470/480/570/570X/580/580X/590] (rev cf)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$ lspci -nn|grep 09:00</span><br></span><span class=token-line style=color:#393A34><span class="token plain">09:00.0 VGA compatible controller [0300]: Advanced Micro Devices, Inc. [AMD/ATI] Ellesmere [Radeon RX 470/480/570/570X/580/580X/590] [1002:67df] (rev cf)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">09:00.1 Audio de</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>VGA has two devices, the first one is the graphics card and the second is the hdmi audio. In some graphics cards are even 3 of them (like usb or serial port). If you going to do a PCI passthrough to a VM you have to pass all the PCI IDs from that card.</p>
<ul>
<li><a href=https://wiki.archlinux.org/title/PCI_passthrough_via_OVMF target=_blank rel="noopener noreferrer">ArchLinux PCI passthrough via OVMF</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=vga-passthrough>VGA Passthrough<a href=#vga-passthrough class=hash-link aria-label="Direct link to VGA Passthrough" title="Direct link to VGA Passthrough">​</a></h3>
<ul>
<li>start.sh</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">#!/bin/bash</span><br></span><span class=token-line style=color:#393A34><span class="token plain"># Helpful to read output when debugging</span><br></span><span class=token-line style=color:#393A34><span class="token plain">set -x</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">echo "hoock start.sh" > /tmp/delete.txt</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"># Stop display manager</span><br></span><span class=token-line style=color:#393A34><span class="token plain">systemctl stop display-manager.service</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">## Uncomment the following line if you use GDM</span><br></span><span class=token-line style=color:#393A34><span class="token plain">#killall gdm-x-session</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"># Unbind VTconsoles</span><br></span><span class=token-line style=color:#393A34><span class="token plain"># /sys/devices/virtual/vtconsole/vtcon0/bind</span><br></span><span class=token-line style=color:#393A34><span class="token plain">echo 0 > /sys/class/vtconsole/vtcon0/bind</span><br></span><span class=token-line style=color:#393A34><span class="token plain">echo 0 > /sys/devices/virtual/vtconsole/vtcon1/bind</span><br></span><span class=token-line style=color:#393A34><span class="token plain"># If have a 2ndn vga:</span><br></span><span class=token-line style=color:#393A34><span class="token plain">#echo 0 > /sys/class/vtconsole/vtcon1/bind</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"># Unbind EFI-Framebuffer</span><br></span><span class=token-line style=color:#393A34><span class="token plain">#echo efi-framebuffer.0 > /sys/bus/platform/drivers/efi-framebuffer/unbind || true</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"># Avoid a Race condition by waiting 2 seconds. This can be calibrated to be shorter or longer if required for your system</span><br></span><span class=token-line style=color:#393A34><span class="token plain">sleep 2</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"># Unload all Nvidia drivers</span><br></span><span class=token-line style=color:#393A34><span class="token plain">#modprobe -r nvidia_drm</span><br></span><span class=token-line style=color:#393A34><span class="token plain">#modprobe -r nvidia_modeset</span><br></span><span class=token-line style=color:#393A34><span class="token plain">#modprobe -r nvidia_uvm</span><br></span><span class=token-line style=color:#393A34><span class="token plain">#modprobe -r nvidia</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"># Unload 2nd VGA AMDGPU driver</span><br></span><span class=token-line style=color:#393A34><span class="token plain">#DEVS="0000_0a_00_0 0000_0a_00_1"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">#for DEV in $DEVS; do</span><br></span><span class=token-line style=color:#393A34><span class="token plain">#  echo -n "$DEV -> "</span><br></span><span class=token-line style=color:#393A34><span class="token plain">#  virsh nodedev-detach pci_${DEV} || ( sleep 1 ; virsh nodedev-detach pci_${DEV} )</span><br></span><span class=token-line style=color:#393A34><span class="token plain">#done</span><br></span><span class=token-line style=color:#393A34><span class="token plain">#sleep 1</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"># Unbind the GPU from display driver</span><br></span><span class=token-line style=color:#393A34><span class="token plain">#virsh nodedev-detach pci_0000_09_00_0</span><br></span><span class=token-line style=color:#393A34><span class="token plain">#virsh nodedev-detach pci_0000_09_00_1</span><br></span><span class=token-line style=color:#393A34><span class="token plain">DEVS="0000_09_00_0 0000_09_00_1"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">for DEV in $DEVS; do</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  echo -n "$DEV -> "</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  virsh nodedev-detach pci_${DEV} || ( sleep 1 ; virsh nodedev-detach pci_${DEV} )</span><br></span><span class=token-line style=color:#393A34><span class="token plain">done</span><br></span><span class=token-line style=color:#393A34><span class="token plain">sleep 1</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"># Unload AMD GPU driver</span><br></span><span class=token-line style=color:#393A34><span class="token plain">modprobe -r amdgpu</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"># Load VFIO Kernel Module</span><br></span><span class=token-line style=color:#393A34><span class="token plain">modprobe vfio-pci</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<ul>
<li>revert.sh</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">#!/bin/bash</span><br></span><span class=token-line style=color:#393A34><span class="token plain">set -x</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">echo "revert.sh" >> /tmp/deleteme.txt</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"># Unload VFIO-PCI Kernel Driver</span><br></span><span class=token-line style=color:#393A34><span class="token plain">modprobe -r vfio-pci</span><br></span><span class=token-line style=color:#393A34><span class="token plain">modprobe -r vfio_iommu_type1</span><br></span><span class=token-line style=color:#393A34><span class="token plain">modprobe -r vfio</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><br></span><span class=token-line style=color:#393A34><span class="token plain"># Re-Bind GPU to Nvidia Driver</span><br></span><span class=token-line style=color:#393A34><span class="token plain">#virsh nodedev-reattach pci_0000_0c_00_1</span><br></span><span class=token-line style=color:#393A34><span class="token plain">#virsh nodedev-reattach pci_0000_0c_00_0</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"># Re-Bind GPU to AMDGPU Driver</span><br></span><span class=token-line style=color:#393A34><span class="token plain">#virsh nodedev-reattach pci_0000_09_00_1</span><br></span><span class=token-line style=color:#393A34><span class="token plain">#virsh nodedev-reattach pci_0000_09_00_0</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">DEVS="0000_09_00_1 0000_09_00_0"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">for DEV in $DEVS; do</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  echo -n "$DEV -> "</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  virsh nodedev-reattach pci_${DEV}</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  echo "$DEV" > /sys/bus/pci/devices/$DEV/driver/unbind</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  echo "$DEV" > /sys/bus/pci/drivers/vfio-pci/unbind</span><br></span><span class=token-line style=color:#393A34><span class="token plain">done</span><br></span><span class=token-line style=color:#393A34><span class="token plain">sleep 1</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"># Re-Bind AMDGPU</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">#DEVS="0000_0a_00_0 0000_0a_00_1"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">#</span><br></span><span class=token-line style=color:#393A34><span class="token plain">#for DEV in $DEVS; do</span><br></span><span class=token-line style=color:#393A34><span class="token plain">#  echo -n "$DEV -> "</span><br></span><span class=token-line style=color:#393A34><span class="token plain">#  virsh nodedev-reattach pci_${DEV}</span><br></span><span class=token-line style=color:#393A34><span class="token plain">#done</span><br></span><span class=token-line style=color:#393A34><span class="token plain">#sleep 1</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"># Rebind VT consoles</span><br></span><span class=token-line style=color:#393A34><span class="token plain">echo 1 > /sys/class/vtconsole/vtcon0/bind</span><br></span><span class=token-line style=color:#393A34><span class="token plain"># Some machines might have more than 1 virtual console. Add a line for each corresponding VTConsole</span><br></span><span class=token-line style=color:#393A34><span class="token plain">#echo 1 > /sys/class/vtconsole/vtcon1/bind</span><br></span><span class=token-line style=color:#393A34><span class="token plain">echo 1 > /sys/devices/virtual/vtconsole/vtcon1/bind</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">#nvidia-xconfig --query-gpu-info > /dev/null 2>&1</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">#modprobe nvidia_drm</span><br></span><span class=token-line style=color:#393A34><span class="token plain">#modprobe nvidia_modeset</span><br></span><span class=token-line style=color:#393A34><span class="token plain">#modprobe nvidia_uvm</span><br></span><span class=token-line style=color:#393A34><span class="token plain">#modprobe nvidia</span><br></span><span class=token-line style=color:#393A34><span class="token plain">#sleep as test</span><br></span><span class=token-line style=color:#393A34><span class="token plain">sleep 2</span><br></span><span class=token-line style=color:#393A34><span class="token plain">modprobe amdgpu</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">#echo "efi-framebuffer.0" > /sys/bus/platform/drivers/efi-framebuffer/bind</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"># Restart Display Manager</span><br></span><span class=token-line style=color:#393A34><span class="token plain">#systemctl start display-manager.service</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">systemctl start display-manager.service</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<ul>
<li><a href=https://github.com/sdelrio/ansible-workstation/blob/master/roles/kvm/templates/hooks/amd/prepare/begin/start.sh target=_blank rel="noopener noreferrer">My prepare start.sh VM for VGA passthrough</a></li>
<li><a href=https://github.com/sdelrio/ansible-workstation/blob/master/roles/kvm/templates/hooks/amd/release/end/revert.sh target=_blank rel="noopener noreferrer">My release revert VM for VGA passthrough</a></li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=references>References<a href=#references class=hash-link aria-label="Direct link to References" title="Direct link to References">​</a></h4>
<ul>
<li><a href=https://www.reddit.com/r/VFIO/comments/hy2enj/how_to_keep_2nd_passthrough_graphics_card/ target=_blank rel="noopener noreferrer">How to keep 2nd passthrough graphics card</a></li>
<li><a href=https://www.reddit.com/r/VFIO/comments/73og2w/cant_get_amdgpu_driver_to_stop_grabbing_2nd_gpu/ target=_blank rel="noopener noreferrer">AMD GPU driver to stop grabbinb 2nd GPU</a></li>
<li><a href=https://mathiashueber.com/windows-virtual-machine-gpu-passthrough-ubuntu/ target=_blank rel="noopener noreferrer">Beginner friendly guide to VM with GPU passtrhough on Ubuntu 18</a></li>
<li><a href=https://github.com/joeknock90/Single-GPU-Passthrough target=_blank rel="noopener noreferrer">GitHub: joeknock90 - Single GPU Passthrough on Linux</a></li>
<li><a href="https://www.techpowerup.com/vgabios/?architecture=AMD&manufacturer=MSI&model=RX+470&version=015.050.000.000.000000&interface=&memType=&memSize=&since=" target=_blank rel="noopener noreferrer">Video RX470 BIOS Collection</a></li>
<li><a href=https://wiki.archlinux.org/title/PCI_passthrough_via_OVMF#UEFI_(OVMF)_compatibility_in_VBIOS target=_blank rel="noopener noreferrer">UEFI (OVMF) compatibility in VBIOS</a></li>
<li><a href=https://www.reddit.com/r/VFIO/comments/c93kqs/cannot_unbind_guest_gpu_from_amdgpu_driver/ target=_blank rel="noopener noreferrer">Reddit: Cannot unbind guest GPU from amdgpu driver</a></li>
<li><a href=https://wiki.archlinux.org/title/PCI_passthrough_via_OVMF target=_blank rel="noopener noreferrer">PCI passwthrough via OVMF</a></li>
<li><a href=https://forum.level1techs.com/t/vfio-in-2019-pop-os-how-to-general-guide-though-draft/142287 target=_blank rel="noopener noreferrer">VFIO in 2019 – Pop!_OS How-To (General Guide though)</a></li>
<li><a href=https://bytee.net/blog/kvm-gpu-pass-through-with-identical-cards target=_blank rel="noopener noreferrer">Linux KVM GPU pass-through with identical graphic cards</a></li>
<li><a href=http://vfio.blogspot.com/2015/05/vfio-gpu-how-to-series-part-3-host.htmlo target=_blank rel="noopener noreferrer">VFIO GPU How To series, part 3 - Host configuration</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=remove-the-device-and-rescan-pcie-bus>Remove the device and rescan PCIe bus<a href=#remove-the-device-and-rescan-pcie-bus class=hash-link aria-label="Direct link to Remove the device and rescan PCIe bus" title="Direct link to Remove the device and rescan PCIe bus">​</a></h3>
<p>Removing the PCIe device via the remove function in its directory and reloading it via the PCIe bus' rescan function causes the kernel to power-cycle the PCIe device without rebooting your computer.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">echo "1" > /sys/bus/pci/devices/DDDD\:BB\:DD.F/remove</span><br></span><span class=token-line style=color:#393A34><span class="token plain">sleep 1</span><br></span><span class=token-line style=color:#393A34><span class="token plain">echo "1" > /sys/bus/pci/rescan</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>In the above code, <code>DDDD:BB:DD.F</code> is the device slot format Domain:Bus<!-- -->:Device<!-- -->.Function.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"/></svg></span>AMD VGA</div><div class=admonitionContent_BuS1><p>On some Radeon cards, it can't be rebooted</div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=references-1>References<a href=#references-1 class=hash-link aria-label="Direct link to References" title="Direct link to References">​</a></h4>
<ul>
<li><a href=https://unix.stackexchange.com/questions/73908/how-to-reset-cycle-power-to-a-pcie-device/245184#245184 target=_blank rel="noopener noreferrer">https://unix.stackexchange.com/questions/73908/how-to-reset-cycle-power-to-a-pcie-device/245184#245184</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=list-vfio>List VFIO<a href=#list-vfio class=hash-link aria-label="Direct link to List VFIO" title="Direct link to List VFIO">​</a></h3>
<ul>
<li>vfio-list.sh</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">#!/bin/sh</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">DEVS="0000:0a:00.0 0000:0a:00.1"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">for DEV in $DEVS; do</span><br></span><span class=token-line style=color:#393A34><span class="token plain">#  echo "vfio-pci" > "/sys/bus/pci/devices/$DEV/driver_override"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  cat "/sys/bus/pci/devices/$DEV/driver_override"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">#  echo $DEV > "/sys/bus/pci/devices/$DEV/driver/unbind"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">#sudo virsh nodedev-detach pci_0000_0a_00_0</span><br></span><span class=token-line style=color:#393A34><span class="token plain">#sudo virsh nodedev-detach pci_0000_0a_00_1</span><br></span><span class=token-line style=color:#393A34><span class="token plain">done</span><br></span><span class=token-line style=color:#393A34><span class="token plain">sleep 1</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">echo modprobe amdgpu</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">for DEV in $DEVS; do</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  lscpi -s $DEV -v </span><br></span><span class=token-line style=color:#393A34><span class="token plain">done</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">echo # kernel driver used on pcie</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">for DEV in $DEVS; do</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  lscpi -s $DEV -nnk</span><br></span><span class=token-line style=color:#393A34><span class="token plain">done</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=list-iommu-groups>List IOMMU groups<a href=#list-iommu-groups class=hash-link aria-label="Direct link to List IOMMU groups" title="Direct link to List IOMMU groups">​</a></h3>
<ul>
<li><code>ls-iommu.sh</code></li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">#!/bin/bash</span><br></span><span class=token-line style=color:#393A34><span class="token plain">for d in /sys/kernel/iommu_groups/*/devices/*; do</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  n=${d#*/iommu_groups/*}; n=${n%%/*}</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  printf 'IOMMU Group %s ' "$n"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  lspci -nns "${d##*/}"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">done</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=poweroff-discrete-graphis>Poweroff discrete graphis<a href=#poweroff-discrete-graphis class=hash-link aria-label="Direct link to Poweroff discrete graphis" title="Direct link to Poweroff discrete graphis">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">powerdown vga powersave</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<ul>
<li><a href=https://askubuntu.com/questions/771562/16-04-power-off-discrete-graphics-ati-amd target=_blank rel="noopener noreferrer">https://askubuntu.com/questions/771562/16-04-power-off-discrete-graphics-ati-amd</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=vga>VGA<a href=#vga class=hash-link aria-label="Direct link to VGA" title="Direct link to VGA">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=recomendations>Recomendations<a href=#recomendations class=hash-link aria-label="Direct link to Recomendations" title="Direct link to Recomendations">​</a></h3>
<p>For the desktop use case (assuming display performance matters and/or you need multihead support), in order of preference:</p>
<ol>
<li><code>virtio</code> vga or <code>virtio-gpu-pci</code>, if your guest has drivers</li>
<li><code>qxl</code> vga, if your guest has drivers.</li>
</ol>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"/></svg></span>note</div><div class=admonitionContent_BuS1><p>If guest is windows, is recomended to this enable change resolution when you resize the spice window and enable copy/paste from/to VM, so make sure you do this:<ul>
<li>Install <a href=https://www.spice-space.org/download/windows/spice-guest-tools/spice-guest-tools-latest.exe target=_blank rel="noopener noreferrer">spice-guest-tools</a> .</li>
<li>Install spice VD agent.</li>
</ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">apt-get install spice-vdagent</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div><ul>
<li>Make sure that in the qemu xml you have a ve the spicevmc channel into the <code>[devices>...&lt;/devices](devices>...&lt;/devices)</code> section.</li>
</ul><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">[channel type="spicevmc"](channel type="spicevmc")</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  [target type="virtio" name="com.redhat.spice.0" state="disconnected"/](target type="virtio" name="com.redhat.spice.0" state="disconnected"/)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  [alias name="channel0"/](alias name="channel0"/)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  [address type="virtio-serial" controller="0" bus="0" port="1"/](address type="virtio-serial" controller="0" bus="0" port="1"/)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">[/channel](/channel)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div></div></div>
<ol start=3>
<li><code>bochs</code> display device, when using UEFI</li>
<li><code>std</code>, standard VGA</li>
</ol>
<p>For the server use case (assuming the GUI is rarely used, or not at all), in order of preference:</p>
<ol>
<li><code>none</code>: serial console, if you can work without a GUI</li>
<li><code>bochs</code> display device, when using UEFI</li>
<li><code>std</code>, standard VGA</li>
</ol>
<p>On arm systems display devices with a pci memory bar do not work, which reduces the choices alot. We are left with:</p>
<ol>
<li><code>virtio-gpu-pci</code> virtio gpu, if your guest has drivers</li>
<li><code>ramfb</code></li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=references-2>References<a href=#references-2 class=hash-link aria-label="Direct link to References" title="Direct link to References">​</a></h3>
<ul>
<li><a href=https://www.kraxel.org/blog/2019/09/display-devices-in-qemu/ target=_blank rel="noopener noreferrer">VGA and other display devices in qemu</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=pci-passthrough-1>PCI passthrough<a href=#pci-passthrough-1 class=hash-link aria-label="Direct link to PCI passthrough" title="Direct link to PCI passthrough">​</a></h2>
<p>Usually very complex and recomended only for advanced users.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=usb-hotplug>USB hotplug<a href=#usb-hotplug class=hash-link aria-label="Direct link to USB hotplug" title="Direct link to USB hotplug">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=attach-a-usb-device>Attach a USB device<a href=#attach-a-usb-device class=hash-link aria-label="Direct link to Attach a USB device" title="Direct link to Attach a USB device">​</a></h3>
<p>Attach your device to your VM using virtmanager. You will end up with a section like this in your machine definition:</p>
<ol>
<li>Copy this snippets to a new file <code>/etc/libvirt/snippets/SNIPPET.xml</code></li>
</ol>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">[hostdev mode='subsystem' type='usb' managed='yes'](hostdev mode='subsystem' type='usb' managed='yes')</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  [source](source)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    [vendor id='0x04f9'/](vendor id='0x04f9'/)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    [product id='0x2015'/](product id='0x2015'/)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  [/source](/source)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  [address type='usb' bus='0' port='4'/](address type='usb' bus='0' port='4'/)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">[/hostdev](/hostdev)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<ol start=2>
<li>Load the snippet into the Virtual Machine:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">$ virsh attach-device VMNAME /etc/libvirt/snippets/SNIPPET.xml</span><br></span><span class=token-line style=color:#393A34><span class="token plain">Device attached successfully</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<ol start=3>
<li>
<p>Find <code>ENV{PRODUCT}</code> using <code>udevadm monitor --environment</code></p>
</li>
<li>
<p>Add a <code>/etc/udev/rules.d/90-libvirt-usb.rules</code> to automate this plugin and unpluggin using <code>udev</code>.</p>
</li>
</ol>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">ACTION=="add",    SUBSYSTEM=="usb", ENV{PRODUCT}=="4f9/2015/100", RUN+="/usr/bin/virsh attach-device VMNAME /etc/libvirt/snippets/SNIPPET.xml"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">ACTION=="remove", SUBSYSTEM=="usb", ENV{PRODUCT}=="4f9/2015/100", RUN+="/usr/bin/virsh detach-device VMNAME /etc/libvirt/snippets/SNIPPET.xml"</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=references-3>References<a href=#references-3 class=hash-link aria-label="Direct link to References" title="Direct link to References">​</a></h4>
<ul>
<li><a href=https://blog.tinyhost.de/blog/2020-05-01_libvirt_usb.html target=_blank rel="noopener noreferrer">2020: Hotplug USB devices into libvirt VMS</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=huge-pages>Huge Pages<a href=#huge-pages class=hash-link aria-label="Direct link to Huge Pages" title="Direct link to Huge Pages">​</a></h2>
<p>HugePages is a feature integrated into the Linux kernel since v2.6. It makes possible for the OS to suport memory pages greater than the default (usually 4KB). Using very large page sizes can improve system performance by reduccing the ammount of system resources required to access page tables entries.. I't size vary from 2MB to 256oMB, depending on the kernel version and the harware architecture.
This feature is commonly enabled in VMs and big Databases.</p>
<p>For KVM/libvirt case I put a hugepages scripts on <code>/etc/libvirt/hooks/hugepages.sh</code> and then make symbolic links from each libvirtvm hook to that one. For.</p>
<p>Example, if you have 2 VMs named <code>wind10</code> and <code>ubuntu20</code>:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">/etc/libvirt/hooks/</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  huepages.sh</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  qemu</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  qemu.d/</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    win10/</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      prepare/</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        begin/</span><br></span><span class=token-line style=color:#393A34><span class="token plain">          hugepages.sh -> ../../../../hugepages.sh</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      release/</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        end/</span><br></span><span class=token-line style=color:#393A34><span class="token plain">          hugepages.sh -> ../../../../hugepages.sh</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    ubuntu20/</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      prepare/</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        begin/</span><br></span><span class=token-line style=color:#393A34><span class="token plain">          hugepages.sh -> ../../../../hugepages.sh</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      release/</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        end/</span><br></span><span class=token-line style=color:#393A34><span class="token plain">          hugepages.sh -> ../../../../hugepages.sh</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=get-current-hugepages>Get current Hugepages<a href=#get-current-hugepages class=hash-link aria-label="Direct link to Get current Hugepages" title="Direct link to Get current Hugepages">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">grep Huge /proc/meminfo</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=references-4>References<a href=#references-4 class=hash-link aria-label="Direct link to References" title="Direct link to References">​</a></h3>
<ul>
<li><a href=https://github.com/sdelrio/ansible-workstation/blob/master/roles/kvm/files/hooks/hugepages.sh target=_blank rel="noopener noreferrer">My hugepages hook script</a></li>
<li><a href=https://passthroughpo.st/simple-per-vm-libvirt-hooks-with-the-vfio-tools-hook-helper/ target=_blank rel="noopener noreferrer">Howto: Libvirt Automation Using VFIO-Tools Hook Helper</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=isolate-cpus-using-kernes-cgroup-cpuset>Isolate CPUs using kerne's cgroup cpuset<a href=#isolate-cpus-using-kernes-cgroup-cpuset class=hash-link aria-label="Direct link to Isolate CPUs using kerne's cgroup cpuset" title="Direct link to Isolate CPUs using kerne's cgroup cpuset">​</a></h2>
<ul>
<li><a href=https://github.com/PassthroughPOST/VFIO-Tools/blob/master/libvirt_hooks/hooks/cset.sh target=_blank rel="noopener noreferrer">hooks: Add cset CPU isolation hook</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=windonws-10-vm>Windonws 10 VM<a href=#windonws-10-vm class=hash-link aria-label="Direct link to Windonws 10 VM" title="Direct link to Windonws 10 VM">​</a></h2>
<ul>
<li><a href=https://www.heiko-sieger.info/running-windows-10-on-linux-using-kvm-with-vga-passthrough/ target=_blank rel="noopener noreferrer">09/2021: Running Windows 10 on Linux using KVM wiht VGA passthrough</a></li>
<li><a href=https://www.heiko-sieger.info/creating-a-windows-10-vm-on-the-amd-ryzen-9-3900x-using-qemu-4-0-and-vga-passthrough/ target=_blank rel="noopener noreferrer">10/2021: Windows 10 KVM VN on Ryzen 9 3900x using qemu and vga passthrough</a></li>
<li><a href=https://superuser.com/questions/1057959/windows-10-in-kvm-change-boot-disk-to-virtio/1200899#1200899 target=_blank rel="noopener noreferrer">2017: Windows 10 in KVM: change boot disk to Virtio</a></li>
<li><a href=https://github.com/mattshortland/windows-virt-toolkit target=_blank rel="noopener noreferrer">Windows virt toolkit</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=osx-vm>OSX VM<a href=#osx-vm class=hash-link aria-label="Direct link to OSX VM" title="Direct link to OSX VM">​</a></h2>
<ul>
<li><a href=https://github.com/foxlet/macOS-Simple-KVM target=_blank rel="noopener noreferrer">Tools to set up a quick macOS VM in QEMU, accelerated by KVM</a></li>
<li><a href=https://computingforgeeks.com/how-to-run-macos-on-kvm-qemu/ target=_blank rel="noopener noreferrer">How to run macOS on KVM/QEMU</a></li>
<li><a href=https://github.com/SpaceinvaderOne/Macinabox/blob/master/unraid.sh target=_blank rel="noopener noreferrer">Unraid Mac in a Box</a></li>
<li><a href="https://www.youtube.com/watch?v=EtVa_Y7gkxc" target=_blank rel="noopener noreferrer">2020: Video - Easy Opencore macOS big sur on ryzen</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=gaming-vm>Gaming VM<a href=#gaming-vm class=hash-link aria-label="Direct link to Gaming VM" title="Direct link to Gaming VM">​</a></h2>
<ul>
<li><a href=https://rokups.github.io/#!pages/gaming-vm-performance.md target=_blank rel="noopener noreferrer">Performance of your gaming VM</a></li>
<li><a href=https://mathiashueber.com/performance-tweaks-gaming-on-virtual-machines/ target=_blank rel="noopener noreferrer">2021: Guide to performance optimizations for gaming on VM with QEMU and PCI passthrough</a></li>
<li><a href=https://mathiashueber.com/pci-passthrough-ubuntu-2004-virtual-machine/ target=_blank rel="noopener noreferrer">2020: VM with PCI passthrough on Ubuntu 20.04 for gaming machine</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=cpu-pinning>CPU Pinning<a href=#cpu-pinning class=hash-link aria-label="Direct link to CPU Pinning" title="Direct link to CPU Pinning">​</a></h2>
<p>CPU-pinning will allocate CPU-cores for the guest VM while it is running. The idea is the host machine not using the guest CPU cores pinned inside the VM.</p>
<p>A more agresive aproach could be to use <code>isolcpus</code> kernel command line as linux boot parameter to restrict access even if the VM is not running.</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>isolcpu kernel parameters</summary><div><div class=collapsibleContent_i85q><div><div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"/></svg></span>note</div><div class=admonitionContent_BuS1><p><a href=https://wiki.archlinux.org/title/PCI_passthrough_via_OVMF#With_isolcpus_kernel_parameter target=_blank rel="noopener noreferrer">https://wiki.archlinux.org/title/PCI_passthrough_via_OVMF#With_isolcpus_kernel_parameter</a><p>Example, let us assume you are using CPUs 4-7. Use the kernel parameters <code>isolcpus nohz_full rcu_nocbs</code> to completely isolate the CPUs from the kernel. For example:<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">isolcpus=4-7 nohz_full=4-7 rcu_nocbs=4-7</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div><p>Then, run <code>qemu-system-x86_64</code> with taskset and chrt:<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">chrt -r 1 taskset -c 4-7 qemu-system-x86_64 ...</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div><p>The <code>chrt</code> command will ensure that the task scheduler will round-robin distribute work (otherwise it will all stay on the first cpu). For taskset, the CPU numbers can be comma- and/or dash-separated, like "0,1,2,3" or "0-4" or "1,7-8,10" etc.</div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=amd-ryzen-3900>AMD Ryzen 3900<a href=#amd-ryzen-3900 class=hash-link aria-label="Direct link to AMD Ryzen 3900" title="Direct link to AMD Ryzen 3900">​</a></h3>
<p><img decoding=async loading=lazy alt=cpu-ryzen3k src=/assets/images/lstopo-cpu-ryzen3900-c6901e8dae8bf06aef70a1a0f164664b.png width=478 height=540 class=img_ev3q></p>
<p>:::noteScrenshot from lstopo cli tool
Tool to see CPU architecture, usually in all mayor distributions.</p>
<ul>
<li>Ubuntu/Mint: <code>apt-get install hwloc</code>
:::</li>
</ul>
<p>AMD Ryzen 3900 has 12 physical cores, each core with 2 threads, with a total of 24 cores availabe to make the cpu pinning.</p>
<p>The 12 cores are spared in 4 complex of 3 physical cores called CCX.</p>
<p>Each CCX has his own L3 (16MB) cache.</p>
<p>Depending on the power needed inside the VM we could set:</p>
<ul>
<li>1 CCX for the host and 3 CCX for the VM</li>
<li>2 CCX for the host and 2 CCX for the VM</li>
<li>...</li>
<li><code>n</code> CCX for the hots and <code>4-n</code> CCX for the VM</li>
</ul>
<p>In this example will choose 2 for the host and 2 for the VM:</p>
<p><img decoding=async loading=lazy alt="pin cpu ryen3900" src=/assets/images/lstopo-pin-cpu-ryzen3900-24ea067bf50b290a9090480994b1ae37.png width=475 height=536 class=img_ev3q></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=manual-edit-your-vm-xml>Manual edit your VM xml<a href=#manual-edit-your-vm-xml class=hash-link aria-label="Direct link to Manual edit your VM xml" title="Direct link to Manual edit your VM xml">​</a></h4>
<p>Edit your VM xml settings wiht <code>virsh edit your-windows-vm-name</code></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=domain-schema>Domain schema<a href=#domain-schema class=hash-link aria-label="Direct link to Domain schema" title="Direct link to Domain schema">​</a></h4>
<p>Search for</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">[domain type='kvm'](domain type='kvm')</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>and repace with:</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">[domain type='kvm' xmlns:qemu='http://libvirt.org/schemas/domain/qemu/1.0'](domain type='kvm' xmlns:qemu='http://libvirt.org/schemas/domain/qemu/1.0')</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=update-vcpu-section>Update vcpu section<a href=#update-vcpu-section class=hash-link aria-label="Direct link to Update vcpu section" title="Direct link to Update vcpu section">​</a></h4>
<p>Find line within <code>[vcpu>....&lt;/vcpu](vcpu>....&lt;/vcpu)</code> and add the following block:</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">[vcpu placement='static'>12</span><span class="token tag punctuation" style=color:#393A34>&lt;/</span><span class="token tag" style=color:#00009f>vcpu](vcpu</span><span class="token tag" style=color:#00009f> </span><span class="token tag attr-name" style=color:#00a4db>placement</span><span class="token tag attr-value punctuation attr-equals" style=color:#393A34>=</span><span class="token tag attr-value punctuation" style=color:#393A34>'</span><span class="token tag attr-value" style=color:#e3116c>static</span><span class="token tag attr-value punctuation" style=color:#393A34>'</span><span class="token tag punctuation" style=color:#393A34>></span><span class="token plain">12</span><span class="token tag punctuation" style=color:#393A34>&lt;/</span><span class="token tag" style=color:#00009f>vcpu)</span><span class="token tag" style=color:#00009f></span><br></span><span class=token-line style=color:#393A34><span class="token tag" style=color:#00009f></span><span class="token tag attr-name" style=color:#00a4db>[iothreads</span><span class="token tag punctuation" style=color:#393A34>></span><span class="token plain">2</span><span class="token tag punctuation" style=color:#393A34>&lt;/</span><span class="token tag" style=color:#00009f>iothreads](iothreads</span><span class="token tag punctuation" style=color:#393A34>></span><span class="token plain">2&lt;/iothreads)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">[cputune](cputune)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    [vcpupin vcpu='0' cpuset='12'/](vcpupin vcpu='0' cpuset='12'/)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    [vcpupin vcpu='1' cpuset='13'/](vcpupin vcpu='1' cpuset='13'/)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    [vcpupin vcpu='2' cpuset='14'/](vcpupin vcpu='2' cpuset='14'/)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    [vcpupin vcpu='3' cpuset='15'/](vcpupin vcpu='3' cpuset='15'/)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    [vcpupin vcpu='4' cpuset='16'/](vcpupin vcpu='4' cpuset='16'/)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    [vcpupin vcpu='5' cpuset='17'/](vcpupin vcpu='5' cpuset='17'/)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    [vcpupin vcpu='6' cpuset='18'/](vcpupin vcpu='6' cpuset='18'/)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    [vcpupin vcpu='7' cpuset='19'/](vcpupin vcpu='7' cpuset='19'/)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    [vcpupin vcpu='8' cpuset='20'/](vcpupin vcpu='8' cpuset='20'/)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    [vcpupin vcpu='9' cpuset='21'/](vcpupin vcpu='9' cpuset='21'/)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    [vcpupin vcpu='10' cpuset='22'/](vcpupin vcpu='10' cpuset='22'/)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    [vcpupin vcpu='11' cpuset='23'/](vcpupin vcpu='11' cpuset='23'/)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    [emulatorpin cpuset='0-1'/](emulatorpin cpuset='0-1'/)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    [iothreadpin iothread='1' cpuset='0-1'/](iothreadpin iothread='1' cpuset='0-1'/)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    [iothreadpin iothread='2' cpuset='2-3'/](iothreadpin iothread='2' cpuset='2-3'/)</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> [/cputune](/cputune)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=update-cpu-section>Update cpu section<a href=#update-cpu-section class=hash-link aria-label="Direct link to Update cpu section" title="Direct link to Update cpu section">​</a></h4>
<p>Find the block <code>[cpu>...&lt;/cpu](cpu>...&lt;/cpu)</code> and adapt like this:</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">[cpu mode='host-passthrough' check='none'](cpu mode='host-passthrough' check='none')</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    [topology sockets='1' cores='6' threads='2'/](topology sockets='1' cores='6' threads='2'/)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    [cache mode='passthrough'/](cache mode='passthrough'/)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    [feature policy='require' name='topoext'/](feature policy='require' name='topoext'/)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    [!-- add additional cpu features here--](!-- add additional cpu features here--)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">[/cpu](/cpu)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=wakeonlan>WakeonLan<a href=#wakeonlan class=hash-link aria-label="Direct link to WakeonLan" title="Direct link to WakeonLan">​</a></h2>
<p>libvirt-wakenlan, a daemon which listens for wake on LAN packets and starts libvirt based virtual machines</p>
<ul>
<li><a href=https://github.com/simoncadman/libvirt-wakeonlan target=_blank rel="noopener noreferrer">GitHub libvirt-wakeonlan</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=apparmor>Apparmor<a href=#apparmor class=hash-link aria-label="Direct link to Apparmor" title="Direct link to Apparmor">​</a></h2>
<p>When you find some vm not sarting, check for dmesg or <code>/var/log/syslog</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=libvirt-denied-capname-sysrawio>libvirt denied capname <code>sysrawio</code><a href=#libvirt-denied-capname-sysrawio class=hash-link aria-label="Direct link to libvirt-denied-capname-sysrawio" title="Direct link to libvirt-denied-capname-sysrawio">​</a></h3>
<div class="language-log codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-log codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">[ 2592.816582] audit: type=1400 audit(1638036341.363:33): apparmor="DENIED" operation="capable" profile="libvirtd" pid=4545 comm="prio-rpc-worker" capability=17  capname="sys_rawio"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">[ 2593.030984] audit: type=1400 audit(1638036341.575:34): apparmor="DENIED" operation="capable" profile="libvirtd" pid=47974 comm="libvirt_parthel" capability=17  capname="sys_rawio"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">[ 2593.045133] audit: type=1400 audit(1638036341.591:35): apparmor="DENIED" operation="capable" profile="libvirtd" pid=47977 comm="libvirt_parthel" capability=17  capname="sys_rawio"</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>Edit apparmor and add <code>capability sys_rawio,</code> (the comma at the end too) and restart libvirt service</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">sudo vi /etc/apparmor.d/abstractions/libvirt-qemu</span><br></span><span class=token-line style=color:#393A34><span class="token plain">sudo systemctl restart libvirtd</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class=col><a href=https://github.com/sdelrio/golden-forest/edit/master/docs/OS/GNU-Linux/KVM/kvm-qemu.md target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_Z9Sw aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/docs/OS/GNU-Linux/Hardware/notebook><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>Notebook tools</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/docs/OS/GNU-Linux/KVM/kvm-quickemu><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>Quickemu</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#kvm-ui-managers class="table-of-contents__link toc-highlight">KVM UI managers</a><li><a href=#qemuconf class="table-of-contents__link toc-highlight">qemu.conf</a><ul><li><a href=#uefi-bios class="table-of-contents__link toc-highlight">UEFI BIOS</a></ul><li><a href=#virtio-win-isos class="table-of-contents__link toc-highlight">virtio-win isos</a><li><a href=#virtio-fs class="table-of-contents__link toc-highlight">virtio-fs</a><ul><li><a href=#requirements class="table-of-contents__link toc-highlight">Requirements</a><li><a href=#cpu-section-with-numa class="table-of-contents__link toc-highlight">CPU section with NUMA</a><li><a href=#memorybacking-with-source-and-access class="table-of-contents__link toc-highlight">memoryBacking with source and access</a><li><a href=#filesystem-with-virtiofs class="table-of-contents__link toc-highlight">filesystem with virtiofs</a><li><a href=#install-virtiofs-drivers-on-windows class="table-of-contents__link toc-highlight">Install virtiofs drivers on windows</a></ul><li><a href=#pci-passthrough class="table-of-contents__link toc-highlight">PCI passthrough</a><ul><li><a href=#check-if-is-amd_iommuon--amd_iommupt-enabled class="table-of-contents__link toc-highlight">Check if is <code>amd_iommu=on</code> & <code>amd_iommu=pt</code> enabled</a><li><a href=#vga-passthrough class="table-of-contents__link toc-highlight">VGA Passthrough</a><li><a href=#remove-the-device-and-rescan-pcie-bus class="table-of-contents__link toc-highlight">Remove the device and rescan PCIe bus</a><li><a href=#list-vfio class="table-of-contents__link toc-highlight">List VFIO</a><li><a href=#list-iommu-groups class="table-of-contents__link toc-highlight">List IOMMU groups</a><li><a href=#poweroff-discrete-graphis class="table-of-contents__link toc-highlight">Poweroff discrete graphis</a></ul><li><a href=#vga class="table-of-contents__link toc-highlight">VGA</a><ul><li><a href=#recomendations class="table-of-contents__link toc-highlight">Recomendations</a><li><a href=#references-2 class="table-of-contents__link toc-highlight">References</a></ul><li><a href=#pci-passthrough-1 class="table-of-contents__link toc-highlight">PCI passthrough</a><li><a href=#usb-hotplug class="table-of-contents__link toc-highlight">USB hotplug</a><ul><li><a href=#attach-a-usb-device class="table-of-contents__link toc-highlight">Attach a USB device</a></ul><li><a href=#huge-pages class="table-of-contents__link toc-highlight">Huge Pages</a><ul><li><a href=#get-current-hugepages class="table-of-contents__link toc-highlight">Get current Hugepages</a><li><a href=#references-4 class="table-of-contents__link toc-highlight">References</a></ul><li><a href=#isolate-cpus-using-kernes-cgroup-cpuset class="table-of-contents__link toc-highlight">Isolate CPUs using kerne's cgroup cpuset</a><li><a href=#windonws-10-vm class="table-of-contents__link toc-highlight">Windonws 10 VM</a><li><a href=#osx-vm class="table-of-contents__link toc-highlight">OSX VM</a><li><a href=#gaming-vm class="table-of-contents__link toc-highlight">Gaming VM</a><li><a href=#cpu-pinning class="table-of-contents__link toc-highlight">CPU Pinning</a><ul><li><a href=#amd-ryzen-3900 class="table-of-contents__link toc-highlight">AMD Ryzen 3900</a></ul><li><a href=#wakeonlan class="table-of-contents__link toc-highlight">WakeonLan</a><li><a href=#apparmor class="table-of-contents__link toc-highlight">Apparmor</a><ul><li><a href=#libvirt-denied-capname-sysrawio class="table-of-contents__link toc-highlight">libvirt denied capname <code>sysrawio</code></a></ul></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class=footer__title>Docs</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/docs/docs-intro>Tutorial</a></ul></div><div class="col footer__col"><div class=footer__title>Community</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://github.com/sdelrio/golden-forest target=_blank rel="noopener noreferrer" class=footer__link-item>GitHub<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a></ul></div><div class="col footer__col"><div class=footer__title>More</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/blog>Blog</a></ul></div></div><div class="footer__bottom text--center"><div class=footer__copyright>Copyright © 2025 The Golden Forest project. Built with Docusaurus.</div></div></div></footer></div>