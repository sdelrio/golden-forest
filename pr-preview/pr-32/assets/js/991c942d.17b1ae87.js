"use strict";(self.webpackChunkgolden_forest_website=self.webpackChunkgolden_forest_website||[]).push([[1040],{28453:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>d});var o=r(96540);const i={},a=o.createContext(i);function t(e){const n=o.useContext(a);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),o.createElement(a.Provider,{value:n},e.children)}},67891:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>s,contentTitle:()=>d,default:()=>u,frontMatter:()=>t,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"Containers/Docker/dockerfile-java","title":"Dockerfile for Java","description":"Starting with Java 9 you could build a custom JRE with just the libraries you need using the tool jlink, provided with the Java 9 JDK.","source":"@site/docs/Containers/Docker/dockerfile-java.md","sourceDirName":"Containers/Docker","slug":"/Containers/Docker/dockerfile-java","permalink":"/golden-forest/pr-preview/pr-32/docs/Containers/Docker/dockerfile-java","draft":false,"unlisted":false,"editUrl":"https://github.com/sdelrio/golden-forest/edit/master/docs/Containers/Docker/dockerfile-java.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Docker for windows","permalink":"/golden-forest/pr-preview/pr-32/docs/Containers/Docker/docker-windows"},"next":{"title":"Dockerfile for node.js","permalink":"/golden-forest/pr-preview/pr-32/docs/Containers/Docker/dockerfile-node"}}');var i=r(74848),a=r(28453);const t={},d="Dockerfile for Java",s={},l=[{value:"Java 9",id:"java-9",level:2},{value:"First stage",id:"first-stage",level:3},{value:"Second stage",id:"second-stage",level:3},{value:"bin/run",id:"binrun",level:4},{value:"References",id:"references",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"dockerfile-for-java",children:"Dockerfile for Java"})}),"\n",(0,i.jsxs)(n.p,{children:["Starting with Java 9 you could build a custom JRE with just the libraries you need using the tool ",(0,i.jsx)(n.code,{children:"jlink"}),", provided with the Java 9 JDK."]}),"\n",(0,i.jsxs)(n.p,{children:["The combination of a small Alpine Linux distro (5 MB) and our stripped down JRE (30 MB), could results in a total Docker image size of approximately 35 MB. By comparison, the ",(0,i.jsx)(n.code,{children:"openjdk:8-jre-alpine"})," Docker image is 80 MB. A reduction of more than 50 percent!"]}),"\n",(0,i.jsx)(n.h2,{id:"java-9",children:"Java 9"}),"\n",(0,i.jsx)(n.h3,{id:"first-stage",children:"First stage"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"FROM alpine:3.6 AS builder\n\nMAINTAINER JDriven <info@jdriven.com>\n\nENV JAVA_HOME=/opt/jdk \\\n    PATH=${PATH}:/opt/jdk/bin \\\n    LANG=C.UTF-8\n\nRUN set -ex && \\\n    apk add --no-cache bash && \\\n    wget http://download.java.net/java/jdk9-alpine/archive/181/binaries/jdk-9-ea+181_linux-x64-musl_bin.tar.gz -O jdk.tar.gz && \\\n    mkdir -p /opt/jdk && \\\n    tar zxvf jdk.tar.gz -C /opt/jdk --strip-components=1 && \\\n    rm jdk.tar.gz && \\\n    rm /opt/jdk/lib/src.zip\n\nWORKDIR /app\n\nCOPY backend-module/target/backend-module-1.0-SNAPSHOT.jar .\nCOPY frontend-module/target/frontend-module-1.0-SNAPSHOT.jar .\n\nRUN jlink --module-path backend-module-1.0-SNAPSHOT.jar:frontend-module-1.0-SNAPSHOT.jar:$JAVA_HOME/jmods \\\n        --add-modules com.jdriven.java9runtime.frontend \\\n        --launcher run=com.jdriven.java9runtime.frontend/com.jdriven.java9runtime.frontend.FrontendApplication \\\n        --output dist \\\n        --compress 2 \\\n        --strip-debug \\\n        --no-header-files \\\n        --no-man-pages\n"})}),"\n",(0,i.jsx)(n.h3,{id:"second-stage",children:"Second stage"}),"\n",(0,i.jsx)(n.p,{children:"Copies the custom JRE into our image and runs it"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'FROM alpine:3.6\n\nMAINTAINER JDriven <info@jdriven.com>\n\nWORKDIR /app\n\nCOPY --from=builder /app/dist/ ./\n\nENTRYPOINT ["bin/run"]\n'})}),"\n",(0,i.jsx)(n.h4,{id:"binrun",children:"bin/run"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"#!/bin/sh\nJLINK_VM_OPTIONS=\nDIR=`dirname $0`\n$DIR/java $JLINK_VM_OPTIONS -m com.jdriven.java9runtime.frontend/com.jdriven.java9runtime.frontend.FrontendApplication $@\n"})}),"\n",(0,i.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://blog.jdriven.com/2017/11/modular-java-9-runtime-docker-alpine/",children:"2017: Slim modular Java 9 runtime Docker image with Alpine Linux"})}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}}}]);