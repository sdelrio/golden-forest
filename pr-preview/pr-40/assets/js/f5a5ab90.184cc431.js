"use strict";(self.webpackChunkgolden_forest_website=self.webpackChunkgolden_forest_website||[]).push([["5472"],{85291:function(e,n,s){s.r(n),s.d(n,{default:()=>h,frontMatter:()=>l,metadata:()=>t,assets:()=>a,toc:()=>d,contentTitle:()=>o});var t=JSON.parse('{"id":"Cloud-Platform/Kubernetes/k8s-distributions","title":"K8s distributions","description":"k0s","source":"@site/docs/Cloud-Platform/Kubernetes/k8s-distributions.md","sourceDirName":"Cloud-Platform/Kubernetes","slug":"/Cloud-Platform/Kubernetes/k8s-distributions","permalink":"/pr-preview/pr-40/docs/Cloud-Platform/Kubernetes/k8s-distributions","draft":false,"unlisted":false,"editUrl":"https://github.com/sdelrio/golden-forest/edit/master/docs/Cloud-Platform/Kubernetes/k8s-distributions.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"kubectl usefull commands","permalink":"/pr-preview/pr-40/docs/Cloud-Platform/Kubernetes/k8s-cli-quick-guide"},"next":{"title":"K8s hardening","permalink":"/pr-preview/pr-40/docs/Cloud-Platform/Kubernetes/k8s-hardening"}}'),r=s("85893"),i=s("50065");let l={},o="K8s distributions",a={},d=[{value:"k0s",id:"k0s",level:2},{value:"k3s",id:"k3s",level:2},{value:"Remove k3s ingress-nginx",id:"remove-k3s-ingress-nginx",level:3},{value:"Containerd disk location",id:"containerd-disk-location",level:3},{value:"Master no-schedule",id:"master-no-schedule",level:3},{value:"On install",id:"on-install",level:4},{value:"On already installed system",id:"on-already-installed-system",level:4},{value:"flannel UFW",id:"flannel-ufw",level:3},{value:"Ansible",id:"ansible",level:4},{value:"Backup and restore",id:"backup-and-restore",level:3},{value:"ETCD",id:"etcd",level:4},{value:"Pods",id:"pods",level:4},{value:"kind",id:"kind",level:2},{value:"Simple command to create a kind cluster",id:"simple-command-to-create-a-kind-cluster",level:3},{value:"Issues",id:"issues",level:3},{value:"Stuck at &quot;Starting control panel&quot;",id:"stuck-at-starting-control-panel",level:4},{value:"Create cluster fails - kind-control-plane does not work on zfs",id:"create-cluster-fails---kind-control-plane-does-not-work-on-zfs",level:4},{value:"ZFS workarounds",id:"zfs-workarounds",level:4},{value:"Install cluster",id:"install-cluster",level:2},{value:"Deploy clusters",id:"deploy-clusters",level:3},{value:"Containerd logs",id:"containerd-logs",level:3},{value:"KUBECONFIG",id:"kubeconfig",level:3},{value:"Kubespray",id:"kubespray",level:2},{value:"References",id:"references",level:3},{value:"Flatcar",id:"flatcar",level:2}];function c(e){let n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"k8s-distributions",children:"K8s distributions"})}),"\n",(0,r.jsx)(n.h2,{id:"k0s",children:"k0s"}),"\n",(0,r.jsx)(n.p,{children:"All-inclusive k8s distribution configured with all features to build a k8s cluster and packaged as a single binary for easy of use."}),"\n",(0,r.jsx)(n.p,{children:"Can fit in any cloud environment, iOT, Edge and Bare Metal."}),"\n",(0,r.jsx)(n.p,{children:"Simply design, modest system requirements (1 vCPU, 1GB RAM)."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://k0sproject.io/",children:"https://k0sproject.io/"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://docs.k0sproject.io/v1.22.3+k0s.0/",children:"https://docs.k0sproject.io/v1.22.3+k0s.0/"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://medium.com/k0sproject/k0s-0-9-released-4f8530fb3530",children:"https://medium.com/k0sproject/k0s-0-9-released-4f8530fb3530"})}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"k3s",children:"k3s"}),"\n",(0,r.jsx)(n.p,{children:"Lightweight Kubernetes, certified disribution for IoT & Edge computing."}),"\n",(0,r.jsx)(n.p,{children:"It doesn't have any cloud feature (no AWS, no GKE), so it's very small. Packaged with a single <50MB binary."}),"\n",(0,r.jsx)(n.h3,{id:"remove-k3s-ingress-nginx",children:"Remove k3s ingress-nginx"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"kubectl delete helmcharts ingress-nginx -n kube-system\n"})}),"\n",(0,r.jsx)(n.p,{children:"and then"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"systemctl restart k3s.service\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/k3s-io/k3s/issues/737",children:"Unable tore-deploying manifest after change"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"containerd-disk-location",children:"Containerd disk location"}),"\n",(0,r.jsxs)(n.p,{children:["The normal directory ",(0,r.jsx)(n.code,{children:"/var/lib/containerd"})," is not the one used in k3s for the container layers. Instead is the ",(0,r.jsx)(n.code,{children:"/run/k3s/containerd"})," but is a ",(0,r.jsx)(n.code,{children:"tmpfs"})," mount."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"root@k3s-1:~# cat /proc/self/mounts | awk '{print $2}' | grep '^/run/k3s' | head -n 5\n/run/k3s/containerd/io.containerd.grpc.v1.cri/sandboxes/dab3158b11a58caedc3f485af984f033a07f94e933046a6da1a00573bc5dd9db/shm\n/run/k3s/containerd/io.containerd.runtime.v2.task/k8s.io/dab3158b11a58caedc3f485af984f033a07f94e933046a6da1a00573bc5dd9db/rootfs\n/run/k3s/containerd/io.containerd.runtime.v2.task/k8s.io/a2a3d5d172be7f269850d7f6d6ee569b51b9d1257a54823c96ce6bcfeb25bee3/rootfs\n/run/k3s/containerd/io.containerd.grpc.v1.cri/sandboxes/2e1e05c5d5503ab760dea5a01a9f1f8f3d2f7f7e16866e93e2384597330834c8/shm\n/run/k3s/containerd/io.containerd.runtime.v2.task/k8s.io/2e1e05c5d5503ab760dea5a01a9f1f8f3d2f7f7e16866e93e2384597330834c8/rootfs\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Searching in the configuration only find something pointing a plugin optional dir to ",(0,r.jsx)(n.code,{children:"/var/lib/rancher/k3s/agent/containerd"}),", to use things like the snapshooter:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"root@k3s-1:~# cat /var/lib/rancher/k3s/agent/etc/containerd/config.toml\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-toml",children:'[plugins.opt]\n  path = "/var/lib/rancher/k3s/agent/containerd"\n\n[plugins.cri]\n  stream_server_address = "127.0.0.1"\n  stream_server_port = "10010"\n  enable_selinux = false\n  enable_unprivileged_ports = true\n  enable_unprivileged_icmp = true\n  sandbox_image = "rancher/mirrored-pause:3.6"\n\n[plugins.cri.containerd]\n  snapshotter = "overlayfs"\n  disable_snapshot_annotations = true\n\n[plugins.cri.containerd.runtimes.runc]\n  runtime_type = "io.containerd.runc.v2"\n\n[plugins.cri.containerd.runtimes.runc.options]\n	SystemdCgroup = false\n'})}),"\n",(0,r.jsx)(n.p,{children:"Searching for containerd in the hard disk and looking into current usage found:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"root@k3s-1:~# for i in /var/lib/rancher/k3s/agent/containerd /var/lib/kubelet /run/k3s/containerd /var/run/k3s/containerd; do du -shc $i; df -h $i; echo; done\n12G	/var/lib/rancher/k3s/agent/containerd\n12G	total\nFilesystem      Size  Used Avail Use% Mounted on\n/dev/nvme0n1p4  418G  317G   80G  80% /\n\n12M	/var/lib/kubelet\n12M	total\nFilesystem      Size  Used Avail Use% Mounted on\n/dev/nvme0n1p4  418G  317G   80G  80% /\n\n5,1G	/run/k3s/containerd\n5,1G	total\nFilesystem      Size  Used Avail Use% Mounted on\ntmpfs           1,6G   61M  1,5G   4% /run\n\n5,1G	/var/run/k3s/containerd\n5,1G	total\nFilesystem      Size  Used Avail Use% Mounted on\ntmpfs           1,6G   61M  1,5G   4% /run\n"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Directory"}),(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Mount"}),(0,r.jsx)(n.th,{style:{textAlign:"center"},children:"Filesystem"}),(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Content"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"/var/lib/rancher/k3s/agent/containerd"})}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"/"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"root disk"}),(0,r.jsx)(n.td,{style:{textAlign:"left"}})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"/var/lib/kubelet"})}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"/"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"root disk"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"plugins (CSI, devices,...), PODs (container webhooks, plugins like emptydir, volumes like secrets & SA tokens )"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"/run/k3s/containerd"})}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"/run"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:(0,r.jsx)(n.code,{children:"tmpfs"})}),(0,r.jsx)(n.td,{style:{textAlign:"left"}})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"/var/run/k3s/containerd"})}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"/run"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:(0,r.jsx)(n.code,{children:"tmpfs"})}),(0,r.jsx)(n.td,{style:{textAlign:"left"}})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"master-no-schedule",children:"Master no-schedule"}),"\n",(0,r.jsx)(n.p,{children:"Master No-schedule except kube-system or other deployments"}),"\n",(0,r.jsx)(n.h4,{id:"on-install",children:"On install"}),"\n",(0,r.jsxs)(n.p,{children:["Add ",(0,r.jsx)(n.code,{children:"--node-taint k3s-controlplane=true:NoExecute"})," to k3s install"]}),"\n",(0,r.jsx)(n.h4,{id:"on-already-installed-system",children:"On already installed system"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Toleration and affinity"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"kubectl taint nodes mynode-01 node-role.kubernetes.io/master=effect:NoSchedule"})}),"\n",(0,r.jsxs)(n.li,{children:["On deployment tolerate ",(0,r.jsx)(n.code,{children:"NoSchedule"}),"and affinity to master."]}),"\n",(0,r.jsxs)(n.li,{children:["Get tainted nodes: ",(0,r.jsx)(n.code,{children:"kubectl get nodes -o json | jq .items[].spec.taints"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: metrics-server\n  namespace: kube-system\n  labels:\n    k8s-app: metrics-server\nspec:\n  selector:\n    matchLabels:\n      k8s-app: metrics-server\n  template:\n    metadata:\n      name: metrics-server\n      labels:\n        k8s-app: metrics-server\n    spec:\n      serviceAccountName: metrics-server\n      tolerations:\n      - key: "node-role.kubernetes.io/master"\n        operator: "Exists"\n        effect: "NoSchedule"\n      affinity:\n        nodeAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n            nodeSelectorTerms:\n            - matchExpressions:\n              - key: "node-role.kubernetes.io/master"\n                operator: In\n                values:\n                - "true"\n      volumes:\n      # mount in tmp so we can safely use from-scratch images and/or read-only containers\n      - name: tmp-dir\n        emptyDir: {}\n      containers:\n      - name: metrics-server\n        image: rancher/metrics-server:v0.3.6\n        volumeMounts:\n        - name: tmp-dir\n          mountPath: /tmp\n'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Labels","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"node-role.kubernetes.io/master=true"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"node-role.kubernetes.io/worker="})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# kubectl get nodes --show-labels\nNAME          STATUS   ROLES    AGE    VERSION         LABELS\nmynode-01   Ready    master   168m   v1.16.3-k3s.2   beta.kubernetes.io/arch=amd64,beta.kubernetes.io/instance-type=k3s,beta.kubernetes.io/os=linux,k3s.io/hostname=mynode-01,k3s.io/internal-ip=212.237.21.49,kubernetes.io/arch=amd64,kubernetes.io/hostname=mynode-01,kubernetes.io/os=linux,node-role.kubernetes.io/master=true\nmynode-02   Ready    worker   168m   v1.16.3-k3s.2   beta.kubernetes.io/arch=amd64,beta.kubernetes.io/instance-type=k3s,beta.kubernetes.io/os=linux,k3s.io/hostname=mynode-02,k3s.io/internal-ip=89.46.65.154,kubernetes.io/arch=amd64,kubernetes.io/hostname=mynode-02,kubernetes.io/os=linux,node-role.kubernetes.io/worker=\n"})}),"\n",(0,r.jsx)(n.h3,{id:"flannel-ufw",children:"flannel UFW"}),"\n",(0,r.jsx)(n.h4,{id:"ansible",children:"Ansible"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'- name: k3s firewall between nodes masters\n  hosts: k3s\n  vars:\n    k3s_all_ips: "{% set IP_ARR=[] %}{% for host in groups[\'k3s\'] %}{% if IP_ARR.insert(loop.index,hostvars[host][\'ansible_ssh_host\']) %}{% endif %}{% endfor %}{{IP_ARR}}"\n    k3s_master_ips: "{% set IP_ARR=[] %}{% for host in groups[\'k3smasters\'] %}{% if IP_ARR.insert(loop.index,hostvars[host][\'ansible_ssh_host\']) %}{% endif %}{% endfor %}{{IP_ARR}}"\n    k3s_workers_ips: "{% set IP_ARR=[] %}{% for host in groups[\'k3sworkers\'] %}{% if IP_ARR.insert(loop.index,hostvars[host][\'ansible_ssh_host\']) %}{% endif %}{% endfor %}{{IP_ARR}}"\n    k3s_all_ips_list: "{{ k3s_all_ips | join(\',\')}}"\n\n  tasks:\n\n    - name: Allow tcp ports kube api, schuduler, controller\n      ufw:\n        rule: allow\n        port: "10250:10252"\n        proto: tcp\n        from_ip: "{{ item }}"\n      with_items: "{{ k3s_all_ips }}"\n      when: isk3s_master is defined and (isk3s_master | bool)\n      tags: [ debug ]\n\n    - name: Allow tcp ports API server\n      ufw:\n        rule: allow\n        port: 6443\n        proto: tcp\n        from_ip: "{{ item }}"\n      with_items: "{{ k3s_all_ips }}"\n      when:  isk3s_master is defined and (isk3s_master | bool)\n      tags: [ debug ]\n\n    - name: Allow udp ports flannel overlay\n      ufw:\n        rule: allow\n        port: 8285\n        proto: udp\n        from_ip: "{{ item }}"\n      with_items: "{{ k3s_all_ips }}"\n      tags: [ debug ]\n\n    - name: Allow udp ports flannel overlay icmp\n      ufw:\n        rule: allow\n        port: 8472\n        proto: udp\n        from_ip: "{{ item }}"\n      with_items: "{{ k3s_all_ips }}"\n      tags: [ debug ]\n\n    - name: Allow tcp ports for NodePort services\n      ufw:\n        rule: allow\n        port: "30000:32767"\n        proto: tcp\n        from_ip: "{{ item }}"\n      with_items: "{{ k3s_all_ips }}"\n      tags: [ debug ]\n\n    - name: Allow cni0 to outside\n      ufw:\n        rule: allow\n        interface: cni0\n        direction: in\n        proto: tcp\n        to_ip: any\n      tags: [ debug ]\n\n    - name: debug\n      debug:\n        var: k3s_ips\n        #        var:  "{{ groups[\'k3sworkers\'] | map(\'extract\', hostvars, [\'ansible_host\']) }}"\n      tags: [ debug ]\n'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Inventory"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ini",children:"[k3s]\nmynode-01\nmynode-02\n\n[k3smasters]\nmynode-01\n\n[k3smasters:vars]\nisk3s_master=true\n\n[k3sworkers]\nmynode-02\n\n[k3sworkers:vars]\nisk3s_worker=true\n"})}),"\n",(0,r.jsx)(n.h3,{id:"backup-and-restore",children:"Backup and restore"}),"\n",(0,r.jsx)(n.h4,{id:"etcd",children:"ETCD"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Command:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"k3s etcd-snapshot"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Doc:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://rancher.com/docs/k3s/latest/en/backup-restore/",children:"https://rancher.com/docs/k3s/latest/en/backup-restore/"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://pet2cattle.com/2022/05/k3s-etcd-s3-backup-restore",children:"https://pet2cattle.com/2022/05/k3s-etcd-s3-backup-restore"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"pods",children:"Pods"}),"\n",(0,r.jsx)(n.h1,{id:"dns-resolve-issues",children:"DNS resolve issues"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Remove DNS from ",(0,r.jsx)(n.code,{children:"/etc/systemd/resolved.conf"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://serverfault.com/questions/925611/temporary-failure-in-name-resolution-to-internal-host",children:"Ubuntu 18 Temporary failure in Name Resolution to internal host"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"kind",children:"kind"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://kind.sigs.k8s.io/",children:"kind"})," is a tool for running local Kubernetes clusters using Docker container \u201Cnodes\u201D.\nkind was primarily designed for testing Kubernetes itself, but may be used for local development or CI."]}),"\n",(0,r.jsx)(n.h3,{id:"simple-command-to-create-a-kind-cluster",children:"Simple command to create a kind cluster"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kind create cluster\nkind create cluster --loglevel=debug\n"})}),"\n",(0,r.jsx)(n.h3,{id:"issues",children:"Issues"}),"\n",(0,r.jsx)(n.h4,{id:"stuck-at-starting-control-panel",children:'Stuck at "Starting control panel"'}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/kubernetes-sigs/kind/issues/440",children:"https://github.com/kubernetes-sigs/kind/issues/440"})}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"create-cluster-fails---kind-control-plane-does-not-work-on-zfs",children:"Create cluster fails - kind-control-plane does not work on zfs"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/kubernetes-sigs/kind/issues/440",children:"https://github.com/kubernetes-sigs/kind/issues/440"})}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"zfs-workarounds",children:"ZFS workarounds"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://gist.github.com/sdelrio/fd628669a9cda68ebc6ca591e1e791ee",children:"https://gist.github.com/sdelrio/fd628669a9cda68ebc6ca591e1e791ee"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/ashald/docker-volume-loopback",children:"https://github.com/ashald/docker-volume-loopback"})}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"install-cluster",children:"Install cluster"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://github.com/k3s-io/k3s-ansible",children:"Ansible"})," (Debian/Ubuntu/CentOS)(x64/arm64/armhf)"]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://thenewstack.io/tutorial-install-a-highly-available-k3s-cluster-at-the-edge/",children:"Tutorial: HA on the Edge (etcd)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://blog.alexellis.io/bare-metal-kubernetes-with-k3s/",children:"Tutorial: Bare-metal (arkade)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://medium.com/@mattiaperi/kubernetes-cluster-with-k3s-and-multipass-7532361affa3",children:"Tutorial: multi-node multipass"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://medium.com/@mattiaperi/kubernetes-cluster-with-k3s-and-multipass-7532361affa3",children:"Tutorial: K3s, Traefik, LE, local-path"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://gitlab.com/k3s_hetzner/k3s_hetzner",children:"Terraform: Hetzner cloud"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://jbhannah.net/articles/k3s-over-watchguard-with-kilo",children:"Kilo: secure k8s over WireGuard"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://medium.com/@lukejpreston/local-kubernetes-development-a14ea8be54d6",children:"k3d: development cluster"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://medium.com/@marcovillarreal_40011/cheap-and-local-kubernetes-playground-with-k3s-helm-5a0e2a110de9",children:"cheap and local k8s playground"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.disasterproject.com/simplify-kubernetes-k3s/",children:"k3s + metallb"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/k3s-io/k3s/blob/master/docker-compose.yml",children:"docker-compose"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.youtube.com/watch?v=4KpVW6jpSnc&feature=share",children:"Video: K8s master class: Speed Up your CN aplications deployment k3s+Traefik"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://pet2cattle.com/2021/05/k3s-autoupgrade",children:"k8s system-upgrae-controller"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://thenewstack.io/tutorial-configure-cloud-native-edge-infrastructure-with-k3s-calico-portworx/",children:"k3s + calico + portworks"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://medium.com/@mabrams_46032/kubernetes-on-raspberry-pi-c246c72f362f",children:"k3s on Raspberry Pi"})," (requires armv7 or higher, 8GB SSD)"]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://zhimin-wen.medium.com/sticky-sessions-in-kubernetes-56eb0e8f257d",children:"k3s + traefik + sticky session"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"deploy-clusters",children:"Deploy clusters"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://thenewstack.io/kubecon-eu-surge-of-kubernetes-edge-deployments-leads-to-cluster-sprawl/",children:"Fleet"})," (fleet is no longer developed or maintained by CoreOS. After February 1, 2018)"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"containerd-logs",children:"Containerd logs"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"/var/lib/rancher/k3s/agent/containerd/containerd.log"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"kubeconfig",children:"KUBECONFIG"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"/etc/rancher/k3s/k3s.yaml"})}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"kubespray",children:"Kubespray"}),"\n",(0,r.jsx)(n.p,{children:"Ansible playbook to deploy a production Ready Kubernetes Cluster"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/kubernetes-sigs/kubespray",children:"Homepage"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/sdelrio/install-k8s-kvm",children:"My Kubespray install on kvm"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://medium.com/@jodywan/cloud-native-devops-09a-ha-kubernetes-with-kubespray-16ec8cd26040",children:"https://medium.com/@jodywan/cloud-native-devops-09a-ha-kubernetes-with-kubespray-16ec8cd26040"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"references",children:"References"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://k3s.io/",children:"Homepage"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://rancher.com/docs/k3s/latest/en/advanced/",children:"Advanced options & configuration"})}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"flatcar",children:"Flatcar"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://thenewstack.io/flatcar-container-linux-the-ideal-os-for-running-kubernetes-at-the-edge/",children:"https://thenewstack.io/flatcar-container-linux-the-ideal-os-for-running-kubernetes-at-the-edge/"})}),"\n"]})]})}function h(e={}){let{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},50065:function(e,n,s){s.d(n,{Z:function(){return o},a:function(){return l}});var t=s(67294);let r={},i=t.createContext(r);function l(e){let n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);