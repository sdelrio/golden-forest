"use strict";(self.webpackChunkgolden_forest_website=self.webpackChunkgolden_forest_website||[]).push([["6780"],{75103:function(e,n,s){s.r(n),s.d(n,{default:()=>h,frontMatter:()=>a,metadata:()=>r,assets:()=>c,toc:()=>l,contentTitle:()=>o});var r=JSON.parse('{"id":"Software-Architecture/microservices","title":"Microservices","description":"Approach","source":"@site/docs/Software-Architecture/microservices.md","sourceDirName":"Software-Architecture","slug":"/Software-Architecture/microservices","permalink":"/golden-forest/docs/Software-Architecture/microservices","draft":false,"unlisted":false,"editUrl":"https://github.com/sdelrio/golden-forest/edit/master/docs/Software-Architecture/microservices.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Office alternatives","permalink":"/golden-forest/docs/Software/office"},"next":{"title":"Streaming and Queue Systems","permalink":"/golden-forest/docs/Software-Architecture/streaming"}}'),t=s("85893"),i=s("50065");let a={},o="Microservices",c={},l=[{value:"Approach",id:"approach",level:2},{value:"Services coupled to each other",id:"services-coupled-to-each-other",level:2},{value:"Risks",id:"risks",level:4},{value:"Good practices",id:"good-practices",level:2},{value:"Event-driven runtimes",id:"event-driven-runtimes",level:2},{value:"Dapr.io",id:"daprio",level:3},{value:"References",id:"references",level:2}];function d(e){let n={a:"a",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",mermaid:"mermaid",p:"p",strong:"strong",ul:"ul",...(0,i.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"microservices",children:"Microservices"})}),"\n",(0,t.jsx)(n.h2,{id:"approach",children:"Approach"}),"\n",(0,t.jsx)(n.p,{children:"Using a microservices approach to application development enables us to improve resilience and expedite our time to market."}),"\n",(0,t.jsx)(n.p,{children:"It\u2019s easier to develop, test, deploy, and most importantly, change and maintain our entire application stack when it\u2019s broken up into little pieces."}),"\n",(0,t.jsx)(n.p,{children:"That said, breaking an app into smaller units does not mean that everything works perfectly right away. Without the proper investigation we could just end with a distributed monolith. It\u2019s important to implement microservices in a particular way."}),"\n",(0,t.jsx)(n.h2,{id:"services-coupled-to-each-other",children:"Services coupled to each other"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Bad practice"})," for production large scale usage."]}),"\n",(0,t.jsx)(n.p,{children:"The \u201Crequest-driven\u201D architectures (e.g. REST) are the simplest and most common pattern of service communication (e.g. Service A asks for some information from Service B and waits. Service B then responds and sends the information to Service A)."}),"\n",(0,t.jsx)(n.p,{children:"Working with HTTP APIs is one of these basic things developers learn and commonly utilize. It\u2019s clear when a request was received and acknowledged by the corresponding service, and there are plenty of tools to debug HTTP APIs. As such, it was our default go-to method to communicate between services across the system. The simplicity of the \u201Crequest-driven\u201D communication served us very well in moving fast, delivering new features, and growing our systems to accommodate all needs."}),"\n",(0,t.jsx)(n.p,{children:"Unfortunately, this pattern means a tight coupling of services."}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"In small systems it works perfectly fine"}),"\n",(0,t.jsx)(n.li,{children:"For microserviers with dozens or hunderds os services, this sort of coupling stops agility and blocks rapid scaling."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:'An illustration of microservices "request-driven" communication, Service A is dependent on B and C'}),"\n",(0,t.jsx)(n.mermaid,{value:'    graph LR;\n        subgraph "request-driven"\n            SA[Service A] --\x3e SB[Service B]\n            SB --\x3e SA\n            SB --\x3e SC[Service C]\n            SC --\x3e SB\n        end\n        subgraph external [External]\n            users[Users] -.-> SA\n            SA -.-> users\n        end\n\n        linkStyle 4 stroke:green,stroke-width:3px,stroke-dasharray:3;\n        linkStyle 5 stroke:green,stroke-width:3px,stroke-dasharray:3;\n        linkStyle default stroke-width:2px,fill:none,stroke:#c0c0c0\n        classDef green fill:#beb,stroke:#ada,stroke-width:2px\n        classDef gray fill:#eee,stroke:#999,stroke-width:2px\n        classDef section color:#808080,fill:none,stroke:#c0c0c0,stroke-width:2px\n        class users green\n        class SA,SB,SC gray\n        class request-driven,external section'}),"\n",(0,t.jsx)(n.h4,{id:"risks",children:"Risks"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:'When using this pattern is that each "core" service (e.g. service C in the above illustration) becomes a single point of failure.'}),"\n",(0,t.jsxs)(n.li,{children:["Dependency chain gets disrupted (mega-disaster):","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"It can potentially create a performance bottleneck"}),"\n",(0,t.jsx)(n.li,{children:"It can potentionally create a downtime of the dependent services."}),"\n",(0,t.jsxs)(n.li,{children:["It might sound like it\u2019s easy to work around, but every service being added to the chain requires:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"A service discovery mechanism (or even a service mesh in big systems)"}),"\n",(0,t.jsx)(n.li,{children:"Failover/retries"}),"\n",(0,t.jsx)(n.li,{children:"Circuit breakers"}),"\n",(0,t.jsx)(n.li,{children:"Timeouts"}),"\n",(0,t.jsx)(n.li,{children:"Caching mechanisms in place - making it a great challenge to work flawlessly end-to-end."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"In practice, using synchronous communications, like REST, across the entire system makes it behave like a monolith or more precisely a distributed monolith that prevents the full benefits of microservices from being enjoyed."}),"\n",(0,t.jsx)(n.p,{children:"An illustration of overly chatty microservices (AKA spaghetti)"}),"\n",(0,t.jsx)(n.mermaid,{value:'    graph BT;\n\n        subgraph "request-driven"\n            subgraph level-1 [" "]\n                auth[Auth] \n                reporting[Reporting]\n                analytics[Analytics]\n            end\n            reporting --- auth\n            reporting --- analytics\n\n            subgraph level-2 [" "]\n                configs[Configs]\n                tracking[Tracking]\n            end\n            configs --- tracking\n            configs --- analytics & tracking & campaings \n    \n            subgraph level-3 [" "]\n                customers[Customers]\n                campaings[Campaings]\n            end\n            customers --- campaings\n            analytics --- tracking\n            campaings --- tracking\n        end\n\n        subgraph external-1 [" "]\n            users-1[Users]\n        end\n        users-1 --- reporting\n\n        subgraph external-2 [" "]\n            users-2[Users]\n        end\n        users-2 --- tracking\n\n        subgraph external-3 [" "]\n            users-3[Users]\n        end\n        users-3 --- customers\n\n        subgraph external-4 [" "]\n            users-4[Users]\n        end\n        users-4 --- campaings\n\n\n        linkStyle 9 stroke:green,stroke-width:3px,stroke-dasharray:3;\n        linkStyle 10 stroke:green,stroke-width:3px,stroke-dasharray:3;\n        linkStyle 11 stroke:green,stroke-width:3px,stroke-dasharray:3;\n        linkStyle 12 stroke:green,stroke-width:3px,stroke-dasharray:3;\n        linkStyle default stroke-width:2px,fill:none,stroke:#c0c0c0\n\n        classDef green fill:#beb,stroke:#ada,stroke-width:2px\n        class users-1,users-2,users-3,users-4 green\n\n        classDef ext color:#808020,fill:none,stroke:#606010,stroke-width:2px\n        class external-1,external-2,external-3,external-4 ext\n\n        classDef section color:#808080,fill:none,stroke:#c0c0c0,stroke-width:2px\n        classDef sectiontrans color:none,fill:none,stroke:none,stroke-width:2px\n        class level-1,level-2,level-3 sectiontrans\n        class request-driven section'}),"\n",(0,t.jsx)(n.h2,{id:"good-practices",children:"Good practices"}),"\n",(0,t.jsx)(n.p,{children:"In order to untangle that mess, the idea is to move many core services to communicate using an asynchronous event-driven architecture."}),"\n",(0,t.jsx)(n.p,{children:"Let the core service publish the information it provides whenever that information is updated, rather than waiting for another service to request that information."}),"\n",(0,t.jsx)(n.p,{children:'By using "push" instead of "pull",  they system handles data in realtime. Now can dispose of many of the complex cache management and purging mechanisms, service discovery, and retries techniques used in the past in order to maintain the reliability and performance of the system while using synchronous services communication.'}),"\n",(0,t.jsx)(n.p,{children:"Services can now:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Publish events to a resilient message broker asynchronously (Kafka in the example )."}),"\n",(0,t.jsx)(n.li,{children:"Trust the broker to route the message to the right service, and the receiving parties subscribe to key events that interest them."}),"\n",(0,t.jsx)(n.li,{children:"Easy to add subscribers and that way they don\u2019t put a further load on the publisher service."}),"\n"]}),"\n",(0,t.jsx)(n.mermaid,{value:'\n    flowchart TB\n\n        subgraph external-1 [" "]\n            users-1[Users]\n        end\n        subgraph external-2 [" "]\n            users-2[Users]\n        end\n        subgraph level-1 [" "]\n            auth[Auth]\n            report[Reporting API]\n        end\n\n        users-1 --- auth\n        users-2 --- report\n\n        subgraph queuesys[" "]\n            queue[Kafka]\n        end\n\n        auth --- queue\n        report --- queue\n\n        subgraph level-2 [" "]\n            analytics\n            configs\n            campaign\n            customers\n        end\n\n        analytics --- queue\n        configs --- queue\n        campaign --- queue\n        customers --- queue\n\n        subgraph external-3 [" "]\n            users-3[Users]\n        end\n        subgraph external-4 [" "]\n            users-4[Users]\n        end\n\n        users-3 --- customers\n        users-4 --- campaign\n\n        linkStyle 0 stroke:green,stroke-width:3px,stroke-dasharray:3;\n        linkStyle 1 stroke:green,stroke-width:3px,stroke-dasharray:3;\n        linkStyle 8 stroke:green,stroke-width:3px,stroke-dasharray:3;\n        linkStyle 9 stroke:green,stroke-width:3px,stroke-dasharray:3;\n        linkStyle default stroke-width:2px,fill:none,stroke:#c0c0c0\n\n        classDef green fill:#beb,stroke:#ada,stroke-width:2px\n        classDef gray fill:#eee,stroke:#999,stroke-width:2px\n        classDef yellow fill:#eeb,stroke:#dda,stroke-width:2px\n        classDef section color:#808080,fill:none,stroke:#c0c0c0,stroke-width:2px\n        classDef queuesection color:#808020,fill:none,stroke:#c0c020,stroke-width:2px\n        classDef ext color:#808020,fill:none,stroke:#606010,stroke-width:2px\n\n        class users-1,users-2,users-3,users-4 green\n        class report,auth,analytics,configs,customers,tracking,campaign gray\n        class queue yellow\n        class level-1,level-2, section\n        class external-1,external-2,external-3,external-4 ext\n        class queuesys queuesection'}),"\n",(0,t.jsx)(n.h2,{id:"event-driven-runtimes",children:"Event-driven runtimes"}),"\n",(0,t.jsx)(n.h3,{id:"daprio",children:(0,t.jsx)(n.a,{href:"https://dapr.io",children:"Dapr.io"})}),"\n",(0,t.jsx)(n.p,{children:"Dapr is a portable, event-driven runtime that makes it easy for any developer to build resilient, stateless and stateful applications that run on the cloud and edge and embraces the diversity of languages and developer frameworks. Leveraging the benefits of a sidecar architecture, Dapr helps you tackle the challenges that come with building microservices and keeps your code platform agnostic."}),"\n",(0,t.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://thenewstack.io/are-your-microservices-overly-chatty/",children:"2019: Are Your Microservices Overly Chatty?"})}),"\n"]})]})}function h(e={}){let{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},50065:function(e,n,s){s.d(n,{Z:function(){return o},a:function(){return a}});var r=s(67294);let t={},i=r.createContext(t);function a(e){let n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);