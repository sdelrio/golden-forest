"use strict";(self.webpackChunkgolden_forest_website=self.webpackChunkgolden_forest_website||[]).push([[6839],{23734:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>i,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"OS/GNU-Linux/HDs/spin-down","title":"Spin Down HDs","description":"Tunning","source":"@site/docs/OS/GNU-Linux/HDs/spin-down.md","sourceDirName":"OS/GNU-Linux/HDs","slug":"/OS/GNU-Linux/HDs/spin-down","permalink":"/PR-32/docs/OS/GNU-Linux/HDs/spin-down","draft":false,"unlisted":false,"editUrl":"https://github.com/sdelrio/golden-forest/edit/master/docs/OS/GNU-Linux/HDs/spin-down.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"S.M.A.R.T. tools","permalink":"/PR-32/docs/OS/GNU-Linux/HDs/smart"},"next":{"title":"Bcache SSD caching","permalink":"/PR-32/docs/OS/GNU-Linux/HDs/ssd-cache"}}');var r=t(74848),s=t(28453);const i={},a="Spin Down HDs",l={},d=[{value:"Tunning",id:"tunning",level:2},{value:"/etc/hdparm.conf",id:"etchdparmconf",level:3},{value:"Advanced Power Management",id:"advanced-power-management",level:3},{value:"Raspberry Pi",id:"raspberry-pi",level:3},{value:"K8s monitoring spindown",id:"k8s-monitoring-spindown",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"spin-down-hds",children:"Spin Down HDs"})}),"\n",(0,r.jsx)(n.h2,{id:"tunning",children:"Tunning"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://arjan.wooning.cz/tips-to-spindown-your-hard-disk-in-debian-or-ubuntu/",children:"https://arjan.wooning.cz/tips-to-spindown-your-hard-disk-in-debian-or-ubuntu/"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"http://www.howtoeverything.net/linux/hardware/permanently-configure-hard-drives-spin-down-after-given-idle-time",children:"http://www.howtoeverything.net/linux/hardware/permanently-configure-hard-drives-spin-down-after-given-idle-time"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://petermolnar.net/article/hard-drive-spindown-clicking-noise/",children:"https://petermolnar.net/article/hard-drive-spindown-clicking-noise/"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"etchdparmconf",children:"/etc/hdparm.conf"}),"\n",(0,r.jsx)(n.p,{children:"hdparm3 is a low-level hard drive utility, and in this case, it has two important parameters:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"-B"})," - Get/set Advanced Power Management feature"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"-S"})," - set the standby (spindown) timeout for the drive"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"APM was not a thing on many old machines, and, by default, it was set to 255, disabled."}),"\n",(0,r.jsx)(n.p,{children:"The spindown timeout was also respected, when it was put into /etc/hdparm.conf, which is not the case any more."}),"\n",(0,r.jsx)(n.h3,{id:"advanced-power-management",children:"Advanced Power Management"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"-B"})," Get/set Advanced Power Management feature, if the drive supports it. A low value means aggressive power management and a high value means better performance. Possible settings range from values 1 through 127 (which permit spin-down), and values 128 through 254 (which do not permit spin-down). The highest degree of power management is attained with a setting of 1, and the highest I/O performance with a setting of 254. A value of 255 tells hdparm to disable Advanced Power Management altogether on the drive (not all drives support disabling it, but most do). Accepts the following values:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Maximum performance ",(0,r.jsx)(n.code,{children:"FEh"})]}),"\n",(0,r.jsxs)(n.li,{children:["Intermediate power management levels without Standby ",(0,r.jsx)(n.code,{children:"81h-FDh"})]}),"\n",(0,r.jsxs)(n.li,{children:["Minimum power consumption without Standby ",(0,r.jsx)(n.code,{children:"80h"})]}),"\n",(0,r.jsxs)(n.li,{children:["Intermediate power management levels with Standby ",(0,r.jsx)(n.code,{children:"02h-7Fh"})]}),"\n",(0,r.jsxs)(n.li,{children:["Minimum power consumption with Standby ",(0,r.jsx)(n.code,{children:"01h"})]}),"\n",(0,r.jsxs)(n.li,{children:["Reserved ",(0,r.jsx)(n.code,{children:"FFh"})]}),"\n",(0,r.jsxs)(n.li,{children:["Reserved ",(0,r.jsx)(n.code,{children:"00h"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"raspberry-pi",children:"Raspberry Pi"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://forums.raspberrypi.com/viewtopic.php?t=188462",children:"https://forums.raspberrypi.com/viewtopic.php?t=188462"})}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"k8s-monitoring-spindown",children:"K8s monitoring spindown"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'apiVersion: apps/v1beta2\nkind: DaemonSet\nmetadata:\n  generation: 9\n  labels:\n    app: prometheus\n    chart: prometheus-6.2.1\n    component: node-exporter\n    heritage: Tiller\n    release: prometheus\n  name: prometheus-node-exporter\n  namespace: prometheus\nspec:\n  revisionHistoryLimit: 10\n  selector:\n    matchLabels:\n      app: prometheus\n      component: node-exporter\n      release: prometheus\n  template:\n    metadata:\n      annotations:\n        field.cattle.io/ports: \'[[{"containerPort":9100,"dnsName":"prometheus-node-exporter-","name":"metrics","protocol":"TCP","sourcePort":0}]]\'\n      creationTimestamp: null\n      labels:\n        app: prometheus\n        component: node-exporter\n        release: prometheus\n    spec:\n      affinity: {}\n      containers:\n      - args:\n        - --path.procfs=/host/proc\n        - --path.sysfs=/host/sys\n        - --collector.filesystem.ignored-mount-points\n        - ^/(sys|proc|dev|mnthost|etc)(|/)\n        - --collector.textfile.directory\n        - /etc/node-exporter/\n        - --no-collector.diskstats\n        - --no-collector.bcache\n        - --no-collector.arp\n        - --no-collector.hwmon\n        - --no-collector.infiniband\n        - --no-collector.ipvs\n        - --no-collector.mdadm\n        - --no-collector.xfs\n        env:\n        - name: HOST_HOSTNAME\n          value: /etc/host_hostname\n        image: basi/node-exporter:v1.15.0\n        imagePullPolicy: IfNotPresent\n        name: prometheus-node-exporter\n        ports:\n        - containerPort: 9100\n          hostPort: 9100\n          name: metrics\n          protocol: TCP\n        resources: {}\n        securityContext: {}\n        terminationMessagePath: /dev/termination-log\n        terminationMessagePolicy: File\n        volumeMounts:\n        - mountPath: /host/proc\n          name: proc\n          readOnly: true\n        - mountPath: /host/sys\n          name: sys\n          readOnly: true\n        - mountPath: /etc/host_hostname\n          name: hostname\n        - mountPath: /etc/node-exporter\n          name: vol1\n        - mountPath: /rootfs\n          name: rootfs\n          readOnly: true\n      - env:\n        - name: FREQUENCY\n          value: "400"\n        - name: STANDBY_TIMEOUT\n          value: "60"\n        image: segator/smart-exporter\n        imagePullPolicy: Always\n        name: smart-exporter\n        resources: {}\n        securityContext:\n          allowPrivilegeEscalation: true\n          privileged: true\n          readOnlyRootFilesystem: false\n          runAsNonRoot: false\n        stdin: true\n        terminationMessagePath: /dev/termination-log\n        terminationMessagePolicy: File\n        tty: true\n        volumeMounts:\n        - mountPath: /dev\n          name: dev\n        - mountPath: /etc/node-exporter\n          name: vol1\n      dnsPolicy: ClusterFirst\n      hostNetwork: true\n      hostPID: true\n      restartPolicy: Always\n      schedulerName: default-scheduler\n      securityContext: {}\n      serviceAccount: prometheus-node-exporter\n      serviceAccountName: prometheus-node-exporter\n      terminationGracePeriodSeconds: 30\n      volumes:\n      - hostPath:\n          path: /proc\n          type: ""\n        name: proc\n      - hostPath:\n          path: /sys\n          type: ""\n        name: sys\n      - hostPath:\n          path: /etc/hostname\n          type: ""\n        name: hostname\n      - hostPath:\n          path: /dev\n          type: ""\n        name: dev\n      - hostPath:\n          path: /srv/node-exporter\n          type: DirectoryOrCreate\n        name: vol1\n      - hostPath:\n          path: /\n          type: ""\n        name: rootfs\n  updateStrategy:\n    type: OnDelete\n'})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>a});var o=t(96540);const r={},s=o.createContext(r);function i(e){const n=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),o.createElement(s.Provider,{value:n},e.children)}}}]);